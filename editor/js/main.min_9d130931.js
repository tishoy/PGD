var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function a(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n["throw"](t))}catch(e){s(e)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,o)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,s&&(a=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(s,i[1])).done)return a;switch(s=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],s=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,a,o,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},CardPop=function(t){function e(e,i){void 0===i&&(i=0);var n=t.call(this)||this;return n.bg_list=["","ptbg","goldbg","diamondbg"],n.head_list=["fun","fail","success"],n.cards=e,n.index=i,n.detail=Config.getInstance().card_tip[n.cards[n.index]],n.getRes(),n}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("card_pop_sheet")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0;var t=new TSBitmap("mask",this.sheet,!0);t.x=320,t.y=498,this.addChild(t),this.card=new egret.Sprite,this.card.x=320,this.card.y=491.7,this.addChild(this.card),this.cardBg=new egret.Bitmap,this.cardBg.texture=this.sheet.getTexture(this.bg_list[this.detail.star]),this.cardBg.anchorOffsetX=this.cardBg.width/2,this.cardBg.anchorOffsetY=this.cardBg.height/2,this.card.addChild(this.cardBg),this.head=new egret.Bitmap,this.head.y=-169.5,this.card.addChild(this.head),this.head_title=new egret.Bitmap,this.head_title.x=-132.85,this.head_title.y=-187.5,this.card.addChild(this.head_title),this.stage_text=new egret.TextField,this.card.addChild(this.stage_text),this.card_name=new egret.TextField,this.card.addChild(this.card_name);RES.getRes("data_scene");this.cardBmp=new egret.Bitmap,this.cardBmp.scaleX=247/144,this.cardBmp.scaleY=246/143,this.cardBmp.y=24,this.card.addChild(this.cardBmp),this.share=new TSBitmap("share",RES.getRes("pops_sheet"),!0),this.share.x=320,this.share.y=758.9,this.share.touchEnabled=!0,this.share.visible=platform.hasShareSDK(),this.addChild(this.share),this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.x=40,this.leftArrow.y=491,this.leftArrow.touchEnabled=!0,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.scaleX=-1,this.rightArrow.x=600,this.rightArrow.y=491,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.touchChildren=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.viewTouched,this),this.share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareTouched,this),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),1===this.cards.length?(this.leftArrow.visible=!1,this.rightArrow.visible=!1):(this.leftArrow.visible=!0,this.rightArrow.visible=!0),this.updateView()},e.prototype.updateView=function(){this.cardBg.texture=this.sheet.getTexture(this.bg_list[this.detail.star]),this.head.texture=this.sheet.getTexture(this.head_list[this.detail.type]+"head"),this.head.anchorOffsetX=this.head.width/2,this.head.anchorOffsetY=this.head.height/2,this.head_title.texture=this.sheet.getTexture(this.head_list[this.detail.type]),this.stage_text.x=-125.6,this.stage_text.y=-178.35,this.stage_text.text="No."+this.detail.No,this.stage_text.width=251.2,this.stage_text.textAlign=egret.HorizontalAlign.CENTER,this.card_name.x=-136.8,this.card_name.y=-127,this.card_name.text=I18nManager.getInstance().getLanguageByGroup(LanguageEnum.GROUP_CARD)[this.detail.No].name,this.card_name.width=275.2,this.card_name.textColor=0,this.card_name.textAlign=egret.HorizontalAlign.CENTER,this.cardBmp.texture=RES.getRes("card_sheet").getTexture(this.detail.No+"_"+this.detail.stage+"_"+this.detail.result),this.cardBmp.anchorOffsetX=this.cardBmp.width/2,this.cardBmp.anchorOffsetY=this.cardBmp.height/2;var t=new egret.TextField;t.x=-72.1,t.y=149.6,t.text=I18nManager.getInstance().getLanguageByName("hard_level"),t.textColor=0,this.card.addChild(t),this.stars=new egret.Sprite;for(var e,i=0;i<this.detail.star;i++)e=new TSBitmap("star",this.sheet),e.x=17.4,e.y=-11,this.stars.addChild(e);this.stars.x=40.55,this.stars.y=162.5,this.card.addChild(this.stars),this.index<=0&&(this.leftArrow.visible=!1),this.index>=this.cards.length-1&&(this.rightArrow.visible=!1)},Object.defineProperty(e.prototype,"id",{set:function(t){this._id=t,this.detail=Config.getInstance().card_tip[t]},enumerable:!0,configurable:!0}),e.prototype.viewTouched=function(t){t.target!==this.leftArrow&&t.target!==this.rightArrow&&UIManager.getInstance().closeCardPop()},e.prototype.shareTouched=function(){platform.share("嘿!我集到了这个卡片,不如我们一起来神回避吧~","https://cdn.joypac.cn/kaihi_h5_res/share.jpg")},e.prototype.leftArrowTouched=function(t){this.index-1<0||(this.index--,this.rightArrow.visible=!0,this.detail=Config.getInstance().card_tip[this.cards[this.index]],this.updateView())},e.prototype.rightArrowTouched=function(t){this.index+1>=this.cards.length||(this.index++,this.leftArrow.visible=!0,this.detail=Config.getInstance().card_tip[this.cards[this.index]],this.updateView())},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(CardPop.prototype,"CardPop",["PopBase"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){Util.curWidth()/Util.curHeight()<Util.displayWidth()/Util.displayHeight()?this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH:this.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT,platform.setLifeCycleCallBack(function(){SoundManager.getInstance().stopBGM()},function(){SoundManager.getInstance().playBGM(),egret.ticker.resume()}),egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),this.runGame()["catch"](function(t){})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,RES.loadConfig("resource/loading.res.json","resource/")];case 1:return i.sent(),[4,RES.loadGroup("loading_ui",0)];case 2:return i.sent(),this.ui_manager=UIManager.getInstance(),this.ui_manager.init(this.stage),this.ui_manager.showLoading(),[4,RES.loadConfig("resource/default.res.json","resource/")];case 3:return i.sent(),window.selectURL="./resource",window.inputStageId=1,console.log(window.selectURL,Number(window.inputStageId)),[4,RES.loadGroup("title_scene")];case 4:return i.sent(),[4,RES.loadGroup("config")];case 5:return i.sent(),this.ui_manager.toTitleScene(),platform.loadingComplete(),t=Config.getInstance(),SaveData.getInstance(),e=ItemController.getInstance(),[4,RES.loadConfig("resource/puzzle_game.res.json","resource/")];case 6:return i.sent(),[4,RES.loadGroup("title")];case 7:return i.sent(),[4,RES.loadGroup("select")];case 8:return i.sent(),[4,RES.loadGroup("game")];case 9:return i.sent(),[4,RES.loadGroup("pop")];case 10:return i.sent(),[4,RES.loadGroup("hint")];case 11:return i.sent(),[4,RES.loadGroup("test")];case 12:return i.sent(),window.top.showLog=!0,window.top.logMsg="资源加载错误",[2]}})})},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Util;!function(t){function e(){return egret.MainContext.instance.stage.stageWidth/720}function i(){return(egret.MainContext.instance.stage.stageWidth-720)/2}function n(){return(egret.MainContext.instance.stage.stageHeight-1280)/2}function r(){return egret.MainContext.instance.stage}function s(){return egret.MainContext.instance.stage.stageWidth}function a(){return egret.MainContext.instance.stage.stageHeight}function o(){return 720}function h(){return 1280}function c(){return egret.MainContext.instance.stage.scaleMode}function l(t,e,i){void 0===e&&(e=1),void 0===i&&(i=0),0===i&&(i=t.totalFrames),t.currentFrame<e||t.currentFrame>=i?t.gotoAndStop(e):t.nextFrame()}function d(t,e){-1===t.indexOf(e)&&t.push(e)}function g(t,e){var i=function(t){var e={r:-1,g:-1,b:-1};return e.b=t%256,e.g=Math.floor(t/256)%256,e.r=Math.floor(t/256/256),e},n=i(e),r=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];r[0]=n.r/255,r[6]=n.g/255,r[12]=n.b/255;var s=new egret.ColorMatrixFilter(r);t.filters=[s]}t.TOTAL_STAGES=30,t.factor=e,t.x_fix=i,t.y_fix=n,t.gameStage=r,t.curWidth=s,t.curHeight=a,t.displayWidth=o,t.displayHeight=h,t.scaleMode=c,t.loopPlay=l,t.singletonPush=d,t.setImageColor=g}(Util||(Util={}));var BlinkEffect=function(t){function e(e,i,n){void 0===n&&(n=!0);var r=t.call(this)||this;return r._target=e,r._time=i,n&&r.start(),r}return __extends(e,t),e.prototype.start=function(){this._currTime=egret.getTimer(),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this)},e.prototype.runDown=function(t){this._target.alpha-=.045,this.checkOver()||this._target.alpha<=.6&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runUp,this))},e.prototype.runUp=function(t){this._target.alpha+=.045,this.checkOver()||this._target.alpha>=1&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this))},e.prototype.checkOver=function(){var t=egret.getTimer();return t-this._currTime>=this._time?(this.destroy(),!0):!1},e.prototype.destroy=function(){this._target.alpha=1,this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,this._target),this._target=null},e}(egret.EventDispatcher);__reflect(BlinkEffect.prototype,"BlinkEffect");var BreathEffect=function(t){function e(e,i,n){void 0===n&&(n=!0);var r=t.call(this)||this;return r._target=e,r._target.anchorOffsetX=r._target.width/2,r._target.anchorOffsetY=r._target.height/2,r._time=i,n&&r.start(),r}return __extends(e,t),e.prototype.start=function(){this._currTime=egret.getTimer(),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this)},e.prototype.runDown=function(t){this._target.scaleX-=.01,this._target.scaleY-=.01,this.checkOver()||this._target.scaleX<=1&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runUp,this))},e.prototype.runUp=function(t){this._target.scaleX+=.01,this._target.scaleY+=.01,this.checkOver()||this._target.scaleX>=1.05&&(this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this._target.addEventListener(egret.Event.ENTER_FRAME,this.runDown,this))},e.prototype.checkOver=function(){if(-1===this._time)return!1;var t=egret.getTimer();return t-this._currTime>=this._time?(this.destroy(),!0):!1},e.prototype.destroy=function(){this._target.scaleX=1,this._target.scaleY=1,this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runDown,this),this._target.removeEventListener(egret.Event.ENTER_FRAME,this.runUp,this),this.dispatchEventWith(egret.Event.COMPLETE,!1,this._target),this._target=null},e}(egret.EventDispatcher);__reflect(BreathEffect.prototype,"BreathEffect");var PopEffect;!function(t){function e(t,e,i,n,r,s){if(void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=!1),!UIManager.getInstance().getPopLayer().contains(t)){e&&(this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),UIManager.getInstance().getPopLayer().contains(this.darkSprite)||UIManager.getInstance().getPopLayer().addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0),UIManager.getInstance().getPopLayer().addChild(t),UIManager.getInstance().setCurrentPop(t),0!=i?(t.x=Util.curWidth()/2-i/2,t.y=Util.curHeight()/2-n/2):(i=t.width,n=t.height);var a=Util.curWidth()/2-i/2,o=Util.curHeight()/2-n/2;switch(r){case 0:break;case 1:t.alpha=0,t.scaleX=.5,t.scaleY=.5,t.x=t.x+i/4,t.y=t.y+n/4,egret.Tween.get(t).to({alpha:1,scaleX:1,scaleY:1,x:t.x-i/4,y:t.y-n/4},300,egret.Ease.backOut);break;case 2:t.alpha=0,t.scaleX=.5,t.scaleY=.5,t.x=t.x+i/4,t.y=t.y+n/4,egret.Tween.get(t).to({alpha:1,scaleX:1,scaleY:1,x:t.x-i/4,y:t.y-n/4},600,egret.Ease.elasticOut);break;case 3:s?(t.x=-i,egret.Tween.get(t).to({x:a},500,egret.Ease.cubicOut)):(t.x=-i,egret.Tween.get(t).to({x:0},500,egret.Ease.cubicOut));break;case 4:s?(t.x=i,egret.Tween.get(t).to({x:a},500,egret.Ease.cubicOut)):(t.x=i,egret.Tween.get(t).to({x:0},500,egret.Ease.cubicOut));break;case 5:s?(t.y=-n,egret.Tween.get(t).to({y:o},500,egret.Ease.cubicOut)):(t.y=-n,egret.Tween.get(t).to({y:0},500,egret.Ease.cubicOut));break;case 6:s?(t.y=Util.curHeight(),egret.Tween.get(t).to({y:o},500,egret.Ease.cubicOut)):(t.y=n,egret.Tween.get(t).to({y:0},500,egret.Ease.cubicOut))}}}function i(t,e){void 0===e&&(e=0);var i=function(){UIManager.getInstance().getPopLayer().contains(this.darkSprite)&&UIManager.getInstance().getPopLayer().removeChild(this.darkSprite)};switch(this.darkSprite&&egret.Tween.get(this.darkSprite).to({alpha:0},100).call(i,this),e){case 0:break;case 1:egret.Tween.get(t).to({alpha:0,scaleX:0,scaleY:0,x:t.x+t.getWidth()/2,y:t.y+t.getHeight()/2},300);break;case 2:break;case 3:egret.Tween.get(t).to({x:t.getWidth()},500,egret.Ease.cubicOut);break;case 4:egret.Tween.get(t).to({x:-t.getWidth()},500,egret.Ease.cubicOut);break;case 5:egret.Tween.get(t).to({y:t.getHeight()},500,egret.Ease.cubicOut);break;case 6:egret.Tween.get(t).to({y:-t.getHeight()},500,egret.Ease.cubicOut)}egret.setTimeout(function(){UIManager.getInstance().getPopLayer().contains(t)&&UIManager.getInstance().getPopLayer().removeChild(t)},this,500)}t.addPopUp=e,t.removePopUp=i}(PopEffect||(PopEffect={}));var TSBitmap=function(t){function e(e,i,n){void 0===i&&(i=null),void 0===n&&(n=!1);var r=t.call(this)||this;return r.init(e,i,n),r}return __extends(e,t),e.prototype.init=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),null===e?RES.hasRes(t)&&(this.texture=RES.getRes(t)):this.texture=e.getTexture(t),i&&(this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2)},e}(egret.Bitmap);__reflect(TSBitmap.prototype,"TSBitmap");var TSButton=function(t){function e(e,i,n,r,s,a,o){void 0===n&&(n="assets"),void 0===r&&(r=null),void 0===s&&(s=""),void 0===a&&(a=30),void 0===o&&(o=1);var h=t.call(this)||this;return h.assets=RES.getRes("assets"),h.isPlayCartoon=!1,h.cartoonType=1,h.param={context:null,data:null},h._cooldownTime=0,h.param.context=e,h.init(i,r,s,a,o,n),h}return __extends(e,t),e.prototype.init=function(t,e,i,n,r,s){void 0===e&&(e=null),void 0===i&&(i=""),void 0===n&&(n=30),void 0===r&&(r=1),void 0===s&&(s="assets"),this.cartoonType=r,this.backFun=e,this.btnImg=new egret.Bitmap,"assets"!=s&&(this.assets=RES.getRes(s)),this.btnImg.texture=this.assets.getTexture(t),this.addChild(this.btnImg),""!=i&&(this.textField=new egret.TextField,this.addChild(this.textField),this.textField.size=n,this.textField.textAlign="center",this.textField.stroke=1,this.textField.strokeColor=0,this.textField.text=i,this.textField.width=this.btnImg.width,this.textField.x=this.btnImg.width/2-this.textField.width/2,this.textField.y=this.btnImg.height/2-this.textField.height/2),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onbuttonTouchTap,this)},e.prototype.onbuttonTouchTap=function(t){if(!this.isPlayCartoon){this.isPlayCartoon=!0;var e=function(){this.isPlayCartoon=!1},i=function(){1==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.elasticOut).call(e,this):2==this.cartoonType?egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},500,egret.Ease.backOut).call(e,this):3==this.cartoonType&&egret.Tween.get(this).to({scaleX:1,scaleY:1,x:this.x-this.btnImg.width/4,y:this.y-this.btnImg.height/4},100).call(e,this)};egret.Tween.get(this).to({scaleX:.5,scaleY:.5,x:this.x+this.btnImg.width/4,y:this.y+this.btnImg.height/4},100,egret.Ease.sineIn).call(i,this),egret.setTimeout(function(){null!=this.backFun&&this.backFun.apply(this.param.context,[this.param.data])},this,300)}},e.prototype.onClick=function(t){this.cdEffect.start(this._cooldownTime),this.touchEnabled=!1},e.prototype.initCooldownEffect=function(){null==this.cdEffect&&(this.cdEffect=new TSEffect.CooldownEffect(this.width,this.height),this.addChild(this.cdEffect),this.cdEffect.addEventListener(TSEffect.CooldownEffect.COOLDOWN_END,this.onCDEnd,this))},e.prototype.onCDEnd=function(t){this.touchEnabled=!0},Object.defineProperty(e.prototype,"cooldownTime",{get:function(){return this._cooldownTime},set:function(t){this._cooldownTime!=t&&(this._cooldownTime=t,this._cooldownTime>0?(this.initCooldownEffect(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)):(this.cdEffect&&(this.cdEffect.parent&&this.removeChild(this.cdEffect),this.cdEffect.removeEventListener(TSEffect.CooldownEffect.COOLDOWN_END,this.onCDEnd,this),this.cdEffect=null),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)))},enumerable:!0,configurable:!0}),e.prototype.startCooldown=function(t){void 0===t&&(t=0),this.initCooldownEffect(),this.cdEffect.start(t),this.touchEnabled=!1},e.prototype.setBindData=function(t){this.param.data=t},e.prototype.getBindData=function(){return this.param.data},e.prototype.getBitmap=function(){return this.btnImg},e}(egret.DisplayObjectContainer);__reflect(TSButton.prototype,"TSButton");var TSEffect;!function(t){function e(t,e){void 0===e&&(e=1e3),new BlinkEffect(t,e)}function i(t,e){return void 0===e&&(e=1e3),new BreathEffect(t,e)}function n(){}t.blinkEffect=e,t.breathEffect=i,t.splash=n;var r=function(t){function e(e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=!0),void 0===r&&(r=!1);var s=t.call(this)||this;return s.color=0,s.alphaC=.6,s.isAnti=!1,s.isRect=!1,s.startFrom=270,s.delay=0,s.duration=0,s.isCooling=!1,s.startTime=0,s.touchChildren=!1,s.touchEnabled=!1,s.isRect=n,s.isAnti=r,s.setSize(e,i),s}return __extends(e,t),e.prototype.setSize=function(t,e){0==e&&(e=t),this.isRect?(this.a=t*Math.SQRT1_2,this.b=e*Math.SQRT1_2):(this.a=.5*t,this.b=.5*e),this.basePos=new egret.Point(.5*t,.5*e),this.rect=new egret.Rectangle(0,0,t,e),this.scrollRect=this.rect},e.prototype.start=function(t,i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var r=egret.getTimer();if(!n&&this.isCooling){if(t+i<this.duration+this.delay-(r-this.startTime))return;this.stop()}this.duration=t,this.delay=i,this.startTime=r,this.isCooling=!0,this.addEventListener(egret.Event.ENTER_FRAME,this.draw,this),this.dispatchEvent(new egret.Event(e.COOLDOWN_START))},e.prototype.stop=function(){this.isCooling=!1,this.removeEventListener(egret.Event.ENTER_FRAME,this.draw,this),this.dispatchEvent(new egret.Event(e.COOLDOWN_END))},e.prototype.reset=function(){this.stop(),this.clear()},e.prototype.clear=function(){this.graphics.clear()},e.prototype.draw=function(t){this.clear();var e=egret.getTimer()-this.startTime-this.delay;if(e>=this.duration)return void this.stop();if(0>=e)var i=0;else i=360*e/this.duration;this.drawBack(),this.drawAngle(i)},e.prototype.drawBack=function(){this.graphics.beginFill(16764108,0),this.isRect?this.graphics.drawRect(0,0,this.rect.width,this.rect.height):this.graphics.drawEllipse(0,0,this.rect.width,this.rect.height),this.graphics.endFill()},e.prototype.drawAngle=function(t){!this.isAnti&&(t=360-t),this.drawSector(t,this.isAnti)},e.prototype.drawSector=function(t,e){void 0===e&&(e=!1);var i=1;e||(i=-1),this.graphics.beginFill(this.color,this.alphaC),this.graphics.lineStyle(0,this.color,0),this.graphics.moveTo(this.basePos.x,this.basePos.y),t=Math.abs(t)>360?360:t;var n=Math.ceil(Math.abs(t)/45),r=t/n;r=r*Math.PI/180;var s=this.startFrom;s=s*Math.PI/180,this.graphics.lineTo(this.basePos.x+this.a*Math.cos(s),this.basePos.y+this.b*Math.sin(s));for(var a=0;n>a;++a){s+=i*r;var o=s-i*r/2,h=this.a/Math.cos(r/2)*Math.cos(o),c=this.b/Math.cos(r/2)*Math.sin(o),l=this.a*Math.cos(s),d=this.b*Math.sin(s);this.graphics.curveTo(this.basePos.x+h,this.basePos.y+c,this.basePos.x+l,this.basePos.y+d)}this.graphics.endFill()},e.COOLDOWN_END="eventEnd",e.COOLDOWN_START="eventStart",e}(egret.Sprite);t.CooldownEffect=r,__reflect(r.prototype,"TSEffect.CooldownEffect")}(TSEffect||(TSEffect={}));var DataController=function(){function t(){this.dataList=[],this.init()}return t.prototype.init=function(){this.saveData=SaveData.getInstance(),this.config=Config.getInstance().card_tip},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.getCanCollectionCard=function(){for(var t=[],e=this.saveData.getStageOpen(),i=1;e>i;i++)this.config[i].No===i&&this.config[i].stage<=e&&t.push(this.config[i]);return t},t.prototype.getCollectionedCards=function(t){for(var e={cards:[],index:0},i=1;i<this.config.length;i++)this.saveData.cardSave[i]>=3&&(t===i&&(e.index=e.cards.length),e.cards.push(i));return e},t.prototype.getCollectionedCardsNumber=function(){for(var t=0,e=0;e<this.saveData.cardSave.length;e++)this.saveData.cardSave[e]>=3&&t++;return t},t.prototype.cardShowHint=function(t){this.saveData.saveCardHintRead(t)},t.prototype.newCardGod=function(t){var e=this.saveData.getCardStatus(t);return 3>e?(this.saveData.saveCardGot(t),!0):!1},t.prototype.getCardId=function(t,e){for(var i=0;i<this.config.length;i++);},t.instance=null,t}();__reflect(DataController.prototype,"DataController");var GameAnalyticsController=function(){function t(){this.init()}return t.prototype.init=function(){"qqplay"===platform.name,"mi"===platform.name&&(platform.print("初始化mi统计"),GameAnalytics("setEnabledInfoLog",!0),GameAnalytics("initialize","fb8ed13df7dcce2fffc17099c94e931c","b2f48e6f6f0b60dbecf249ad56043a6482a0eeca"))},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.stageStartAnalytics=function(t){"qqplay"===platform.name||"mi"===platform.name?(platform.print("关卡开始统计"),GameAnalytics("addProgressionEvent","Start","stage",t)):"wxgame"===platform.name&&platform.analytics("关卡开始",{stage:t})},t.prototype.stageGameOverAnalytics=function(t){"qqplay"===platform.name||"mi"===platform.name?(platform.print("关卡结束统计"),GameAnalytics("addProgressionEvent","Fail","stage",t)):"wxgame"===platform.name&&platform.analytics("关卡失败",{stage:t})},t.prototype.stageClearAnalytics=function(t){"qqplay"===platform.name||"mi"===platform.name?(platform.print("关卡胜利统计"),GameAnalytics("addProgressionEvent","Complete","stage",t)):"wxgame"===platform.name&&platform.analytics("关卡胜利",{stage:t})},t.prototype.stageVedioPlayAnalytics=function(t,e){"qqplay"===platform.name||"mi"===platform.name?(platform.print("视频播放统计"),GameAnalytics("addDesignEvent","StageHint:"+t+":"+e,1)):"wxgame"===platform.name&&platform.analytics("关卡视频广告",{stage:t,hint:e})},t.prototype.cardGotAnalytics=function(t){"qqplay"===platform.name||"mi"===platform.name?(platform.print("卡片获取统计"),t.forEach(function(t){GameAnalytics("addProgressionEvent","Complete","card",t)})):"wxgame"===platform.name&&t.forEach(function(t){platform.analytics("获得卡片",{card:t})})},t.prototype.cardVedioPlayAnalytics=function(t){"qqplay"===platform.name||"mi"===platform.name?(platform.print("卡片视频统计"),GameAnalytics("addDesignEvent","CardHint:"+t,1)):"wxgame"===platform.name&&platform.analytics("卡片视频广告",{card:t})},t.prototype.rankEnterAnalytics=function(){"qqplay"===platform.name||"mi"===platform.name?(platform.print("排行进入统计"),GameAnalytics("addDesignEvent","RankEnter",1)):"wxgame"===platform.name&&platform.analytics("进入排行",{times:1})},t.instance=null,t}();__reflect(GameAnalyticsController.prototype,"GameAnalyticsController");var GuideController=function(){function t(){this._showGuide=!1,this.init()}return t.prototype.init=function(){this._guideStep=0,this._guidePassed=!SaveData.getInstance().isNewPlayer},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.resetStep=function(){this._guideStep=0},t.prototype.nextStep=function(){this._guideStep++},t.prototype.passGuide=function(){this._guidePassed=!0,SaveData.getInstance().passGuide()},Object.defineProperty(t.prototype,"guideStep",{get:function(){return this._guideStep},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showGuide",{get:function(){return!this._guidePassed||this._showGuide},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(GuideController.prototype,"GuideController");var HintController=function(){function t(){this.dataList=[],this.Hints=[],this.init()}return t.prototype.init=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.getStageHintStatus=function(){},t.prototype.setStageHintStatus=function(t){SaveData.getInstance().saveStageHintRead(t)},t.prototype.setCardHintStatus=function(t){SaveData.getInstance().saveCardHintRead(t)},t.instance=null,t}();__reflect(HintController.prototype,"HintController");var ItemController=function(){function t(){this.itemList=[],this.init()}return t.prototype.init=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.hasItem=function(t){for(var e=!1,i=0;i<this.itemList.length;i++)if(this.itemList[i]===t){e=!0;break}return e},t.prototype.addItem=function(t,e){return void 0===e&&(e=!0),5===this.itemList.length?(UIManager.getInstance().showItemFullTip(),!1):this.hasItem(t.id)?!1:(console.log("获得物品id"+t.id),this.itemList.push(t.id),e&&UIManager.getInstance().openItemGetPop(t.res),ItemCtrlView.getInstance().updateItems(t.id,!1),!0)},t.prototype.useItem=function(t){return this.hasItem(t)?(this.itemList.splice(this.getIndexOf(t),1),ItemCtrlView.getInstance().updateItems(!1),!0):!1},t.prototype.getItem=function(t){return this.itemList[t]},t.prototype.resetList=function(){ItemCtrlView.getInstance().cancelItemCurrentDrag(),this.itemList=[],ItemCtrlView.getInstance().updateItems()},t.prototype.getItemList=function(){return this.itemList},t.prototype.getIndexOf=function(t){for(var e=-1,i=0;i<this.itemList.length;i++)if(this.itemList[i]===t){e=i;break}return e},t.instance=null,t}();__reflect(ItemController.prototype,"ItemController");var SettingController=function(){function t(){this.init()}return t.prototype.init=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"SoundPlaying",{get:function(){if(void 0===this._soundPlaying){var t=SaveData.getInstance().getSoundStatus();null===t||void 0===t||""===t||"1"===t?this.SoundPlaying=!0:this._soundPlaying="1"===t?!0:!1}return this._soundPlaying},set:function(t){this._soundPlaying=t,t?(SaveData.getInstance().saveSoundStatus("1"),SoundManager.getInstance().playBGM(),SoundManager.getInstance().playSound(SoundEnum.SELECTSOUND_MP3)):(SaveData.getInstance().saveSoundStatus("0"),SoundManager.getInstance().stopBGM())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lang",{get:function(){if(void 0===this._lang){var t=SaveData.getInstance().getLang();null===t||void 0===t||""===t?this.Lang="zh_CN":this._lang=t}return this._lang},set:function(t){SaveData.getInstance().setLang(t),this._lang=t},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(SettingController.prototype,"SettingController");var StageController=function(){function t(){this.resURL="https://cdn.joypac.cn/kaihi_h5_res/",this.newOpenList=[],this.newClearList=[],this.init()}return t.prototype.init=function(){this.currentSelected=SaveData.getInstance().getLastPlay(),this.dispather=new StageDispather},t.prototype.checkNewStage=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.nextStage=function(){},t.prototype.clearStage=function(t,e,i){return void 0===e&&(e=[]),__awaiter(this,void 0,void 0,function(){var n,r;return __generator(this,function(s){return platform.stopRecord(),ItemController.getInstance().resetList(),n=e.filter(function(t){return DataController.getInstance().newCardGod(t)}),SaveData.getInstance().saveStagePass(t)&&(this.newClearList.push(t),platform.name,1===t&&SaveData.getInstance().isNewPlayer?this.newOpenList=[2,3,4,5,6]:30>t&&(r=SaveData.getInstance().getStageOpen(),this.newOpenList.push(r),this.loadNextStage(r+1))),GameAnalyticsController.getInstance().stageClearAnalytics(t),GameAnalyticsController.getInstance().cardGotAnalytics(n),platform.uploadRank("card_num",DataController.getInstance().getCollectionedCardsNumber()),UIManager.getInstance().openClearPop(t,n,i),[2]})})},t.prototype.gameOverStage=function(t,e,i){void 0===e&&(e=[]),platform.stopRecord(),ItemController.getInstance().resetList();var n=e.filter(function(t){return DataController.getInstance().newCardGod(t)});platform.existRank&&platform.uploadRank("card_num",DataController.getInstance().getCollectionedCardsNumber()),GameAnalyticsController.getInstance().stageGameOverAnalytics(t),GameAnalyticsController.getInstance().cardGotAnalytics(n),UIManager.getInstance().openGameOverPop(t,n,i)},t.prototype.resetStage=function(){ItemController.getInstance().resetList()},t.prototype.getNewOpenList=function(){return this.newOpenList},t.prototype.removeClearFromList=function(t){this.newClearList.splice(t,1)},t.prototype.getNewClearList=function(){return this.newClearList},t.prototype.isStageOpen=function(t){return SaveData.getInstance().getStageOpen()>=t?!0:!1},t.prototype.isStageClear=function(t){return SaveData.getInstance().getStageStatus(t).pass},t.prototype.isStageNew=function(t){return-1!==this.newOpenList.indexOf(t)?!0:!1},t.prototype.getCurrentSelectedName=function(){},t.prototype.getCurrentSelected=function(){return this.currentSelected},t.prototype.getDispather=function(){return this.dispather},t.prototype.startStage=function(t){GameAnalyticsController.getInstance().stageStartAnalytics(t),this.currentSelected=t,UIManager.getInstance().toGameScene()},t.prototype.setSelect=function(t){this.isStageOpen(t)?(this.clearNewOpenList(Math.floor((t-1)/6)+1),this.startStage(t)):this.isStageOpen(t-1)},t.prototype.clearNewOpenList=function(t){for(var e=0;e<this.newOpenList.length&&this.newOpenList[e]<=6*t;)this.newOpenList.shift()
},t.prototype.setNewClearList=function(){},t.prototype.loadSelectURL=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,RES.loadConfig(t+"stage"+e+".res.json",t)];case 1:return i.sent(),[4,RES.loadGroup("stage"+e+"_mp3",0)];case 2:return i.sent(),[4,RES.loadGroup("stage"+e+"_png",0)];case 3:return i.sent(),[4,RES.loadGroup("stage"+e+"_json",0)];case 4:return i.sent(),[2]}})})},t.prototype.loadStage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return"web"!==platform.name&&"oppo"!==platform.name&&"mi"!==platform.name?[3,2]:(console.log("load res from local"),[4,RES.loadConfig("resource/stage"+t+".res.json","resource/")]);case 1:return e.sent(),[3,4];case 2:return 30>=t?(console.log("load res from "+this.resURL),[4,RES.loadConfig("stage"+t+".res.json",this.resURL)]):[3,4];case 3:e.sent(),e.label=4;case 4:return[4,RES.loadGroup("stage"+t+"_mp3",0)];case 5:return e.sent(),[4,RES.loadGroup("stage"+t+"_png",0)];case 6:return e.sent(),[4,RES.loadGroup("stage"+t+"_json",0)];case 7:return e.sent(),[2]}})})},t.prototype.loadNextStage=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return 30>=e?(platform.print("load new stage"+e),[4,RES.loadConfig("stage"+e+".res.json",t.getInstance().resURL)]):[3,5];case 1:return i.sent(),[4,RES.loadGroup("stage"+e+"_mp3",0)];case 2:return i.sent(),[4,RES.loadGroup("stage"+e+"_png",0)];case 3:return i.sent(),[4,RES.loadGroup("stage"+e+"_json",0)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},Object.defineProperty(t.prototype,"parse",{get:function(){return this._parse},set:function(t){this._parse=t},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(StageController.prototype,"StageController");var HintTypeEnum=function(){function t(){}return t.COLLECTION_HINT_ITEM=0,t.STAGE_HINT_ITEM_1=1,t.STAGE_HINT_ITEM_2=2,t.STAGE_HINT_ITEM_3=3,t}();__reflect(HintTypeEnum.prototype,"HintTypeEnum");var ItemEnum=function(){function t(){}return t.getResUrlById=function(t){return this.ITEM_URL[t]},t.ITEM_COVER=0,t.ITEM_MASK=1,t.ITEM_FURIKO=2,t.ITEM_ICE=3,t.ITEM_CAKE=4,t.ITEM_FLOWER_ONE=5,t.ITEM_FLOWER_TWO=6,t.ITEM_FLOWER_THREE=7,t.ITEM_FLOWER_RING=8,t.ITEM_BERRY=9,t.ITEM_UMBRELLA=10,t.ITEM_KANI=11,t.ITEM_TAKO=12,t.ITEM_UKIWA=13,t.ITEM_MIZUGUMO=14,t.ITEM_ICESHOES=15,t.ITEM_BOTTLE=16,t.ITEM_LADDER=17,t.ITEM_BROTHER=18,t.ITEM_TIRE=19,t.ITEM_DAMETIRE=20,t.ITEM_SCREWDRIVER=21,t.ITEM_HOOD=22,t.ITEM_STICK=23,t.ITEM_APPLE=24,t.ITEM_RED_BALL=25,t.ITEM_BLUE_BALL=26,t.ITEM_ROBOT_BALL=27,t.ITEM_RED_ICE=28,t.ITEM_YELLOW_ICE=29,t.ITEM_BLUE_DRINK=30,t.ITEM_FAN=31,t.ITEM_SHELL=32,t.ITEM_STAR=33,t.ITEM_COLORFUL_UMBRELLA=34,t.ITEM_SUNSHINE_UMBRELLA=35,t.ITEM_BLUE_BOOK=36,t.ITEM_RED_BOOK=37,t.ITEM_GREY_BOOK=38,t.ITEM_HAIR_GROW_WATER=39,t.ITEM_CLIPPER=40,t.ITEM_SCISSORS=41,t.ITEM_SEED=42,t.ITEM_BOX=43,t.ITEM_FULL_BOX=44,t.ITEM_ICE_BOX=45,t.ITEM_MUSHROOM=46,t.ITEM_SWEET_POTATO=47,t.ITEM_FIRED_SWEET_POTATO=48,t.ITEM_FLASHLIGHT=49,t.ITEM_PEPER=50,t.ITEM_KELP=51,t.ITEM_FISH=52,t.ITEM_WEEDER=53,t.ITEM_CUP=54,t.ITEM_BREAD=55,t.ITEM_WATER_BUCKET=56,t.ITEM_EMPTY_BUCKET=57,t.ITEM_KEY=58,t.ITEM_SPADE=59,t.ITEM_CAT_TURE=60,t.ITEM_BERRY_BOTTLE=61,t.ITEM_GARLIC=62,t.ITEM_DRUMSTICKS=63,t.ITEM_FISH_FILLET=64,t.ITEM_DURIAN=65,t.ITEM_TOMATO=66,t.ITEM_ON_SALE=67,t.ITEM_BEAF=68,t.ITEM_POTATO=69,t.ITEM_WHITE_EGGS=70,t.ITEM_CARROT=71,t.ITEM_FRIES=72,t.ITEM_TRY_TASTE=73,t.ITEM_YELLOW_EGGS=74,t.ITEM_HUNDRED_YUAN=75,t.ITEM_HUNDRED_ONE_YUAN=76,t.ITEM_TRY_TASTE_STICK=77,t.ITEM_BANANA=78,t.ITEM_JUNGLE_BELL=79,t.ITEM_LITTLE_MING=80,t.ITEM_GOLD_REAVER=81,t.ITEM_REAVER=82,t.ITEM_BANANA_SKIN=83,t.ITEM_RED_BALL_2=84,t.ITEM_RED_BALL_3=85,t.ITEM_APPLE_2=86,t.ITEM_APPLE_3=87,t.ITEM_SEED_1=88,t.ITEM_SEED_2=89,t.ITEM_SEED_3=90,t.ITEM_SEED_4=91,t.ITEM_WATER_BUCKET_1=92,t.ITEM_WATER_BUCKET_2=93,t.ITEM_EMPTY_BUCKET_1=94,t.ITEM_WHITE_EGGS_1=95,t.ITEM_WHITE_EGGS_2=96,t.ITEM_WHITE_EGGS_3=97,t.ITEM_URL=["item_cover","item_mask","item_furiko","item_ice","item_cake","item_flower","item_flower","item_flower","item_flower_ring","item_berry","item_umbrella","item_kani","item_tako","item_ukiwa","item_mizugumo","item_iceshoes","item_bottle","item_ladder","item_brother","item_tire","item_dametire","item_screwdriver","item_hood","item_stick","item_apple","item_red_ball","item_blue_ball","item_robot_ball","item_red_ice","item_yellow_ice","item_blue_drink","item_fan","item_shell","item_star","item_colorful_umbrella","item_sunshine_umbrella","item_blue_book","item_red_book","item_grey_book","item_hair_grow_water","item_clipper","item_scissors","item_seed","item_box","item_full_box","item_ice_box","item_mushroom","item_sweet_potato","item_fired_sweet_potato","item_flashlight","item_peper","item_kelp","item_fish","item_weeder","item_cup","item_bread","item_water_bucket","item_empty_bucket","item_key","item_spade","item_cat_ture","item_berry_bottle","item_garlic","item_drumsticks","item_fish_fillet","item_durian","item_tomato","item_on_sale","item_beaf","item_potato","item_white_eggs","item_carrot","item_fries","item_try_taste","item_yellow_eggs","item_hundred_yuan","item_hundred_one_yuan","item_try_taste_stick","item_banana","item_jungle_bell","item_little_ming","item_gold_reaver","item_reaver","item_banana_skin","item_red_ball","item_red_ball","item_apple","item_apple","item_seed","item_seed","item_seed","item_seed","item_water_bucket","item_water_bucket","item_empty_bucket","item_white_eggs","item_white_eggs","item_white_eggs"],t}();__reflect(ItemEnum.prototype,"ItemEnum");var LanguageEnum=function(){function t(){}return t.GROUP_HINT="hintLang",t.GROUP_CARD="cardLang",t.GROUP_STAGE="stageLang",t.PAGE_SELECT="page_select",t.HINT_TITLE="hint_title",t.STAGE_NO="stage_no",t.TIP_CHANCE="tip_change",t.SHARE_GOT_TIP="share_got_tip",t}();__reflect(LanguageEnum.prototype,"LanguageEnum");var SoundEnum=function(){function t(){}return t.MAIN1SOUND_1_MP3="124_Main1Sound_1_mp3",t.ITEMSOUND_MP3="112_ItemSound_mp3",t.CLICKSOUND_MP3="52_ClickSound_mp3",t.SELECTSOUND_MP3="98_SelectSound_mp3",t.BURST2SOUND_MP3="111_Burst2Sound_mp3",t.GONGSTARTSOUND_MP3="80_GongStartSound_mp3",t.GONGENDSOUND_MP3="81_GongEndSound_1_mp3",t.KICKSOUND_MP3="78_KickSound_mp3",t.KANSEISOUND_1="41_KanseiSound_1_mp3",t.HITSOUND_MP3="40_HitSound_mp3",t.AURA2SOUND_MP3="67_Aura2Sound_mp3",t.AURASOUND_MP3="68_AuraSound_mp3",t.SUBURISOUND_MP3="23_SuburiSound_mp3",t.SHINE2SOUND_MP3="88_Shine2Sound_mp3",t.BOKESOUND_MP3="25_BokeSound_mp3",t.WATER5SOUND_MP3="12_Water5Sound_mp3",t.WATER4SOUND_MP3="15_Water4Sound_mp3",t.VALVESOUND_MP3="17_ValveSound_mp3",t.WATER7SOUND_MP3="21_Water7Sound_mp3",t.WATER6SOUND_MP3="27_Water6Sound_mp3",t.PUYONSOUND_MP3="35_PuyonSound_mp3",t.ASERISOUND_MP3="123_AseriSound_mp3",t.REIZOUKOOPENSOUND_MP3="33_ReizoukoOpenSound_mp3",t.REIZOUKOCLOSESOUND_MP3="34_ReizoukoCloseSound_mp3",t.UPSOUND_MP3="38_UpSound_mp3",t.EATSOUND_MP3="43_EatSound_mp3",t.KUWAGATASOUND_MP3="74_KuwagataSound_mp3",t.WATER8SOUND_MP3="14_Water8Sound_mp3",t.BUSH2SOUND_MP3="113_Bush2Sound_mp3",t.BUSHSOUND_MP3="114_BushSound_mp3",t.AUTODOORSOUND_MP3="125_AutoDoorSound_mp3",t.WINDSOUND_1_MP3="10_WindSound_1_mp3",t.SHINESOUND_MP3="8_ShineSound_mp3",t.UMBRELLASOUND_MP3="3_UmbrellaSound_mp3",t.ZOMBIMOVESOUND_MP3="5_ZombiMoveSound_mp3",t.ZOMBIATTACKSOUND_MP3="20_ZombiAttackSound_mp3",t.ZOMBICLEARSOUND_MP3="64_ZombiClearSound_mp3",t.ZOMBIGAMEOVERSOUND_MP3="65_ZombiGameOverSound_mp3",t.ZOMBIDIGGINGSOUND_MP3="70_ZombiDiggingSound_mp3",t.ZOMBIDEADSOUND_MP3="127_ZombiDeadSound_mp3",t.ZOMBIMARAKASUSOUND_MP3="54_ZombiMarakasuSound_mp3",t.ZOMBIMOVEFASTSOUND_MP3="6_ZombiMoveFastSound_mp3",t.NAMISOUND_1_MP3="57_NamiSound_1_mp3",t.WATER2SOUND_MP3="61_Water2Sound_mp3",t.DOOROPENSOUND_MP3="91_DoorOpenSound_mp3",t.GLASSBREAK2SOUND_MP3="82_GlassBreak2Sound_mp3",t.FREEZESOUND_MP3="96_FreezeSound_mp3",t.SUBERISOUND_MP3="53_SuberiSound_mp3",t.WATERSOUND_MP3="26_WaterSound_mp3",t.DONSOUND_MP3="120_DonSound_mp3",t.KISHIMISOUND_MP3="69_KishimiSound_mp3",t.CATSOUND_MP3="106_CatSound_mp3",t.BURSTSOUND_MP3="119_BurstSound_mp3",t.METAL4SOUND_MP3="72_Metal4Sound_mp3",t.DRINKSOUND_MP3="90_DrinkSound_mp3",t.OPEN2SOUND_MP3="44_Open2Sound_mp3",t.JUMPSOUND_MP3="4_JumpSound_mp3",t.UMASTEPSOUND_MP3="55_UmaStepSound_mp3",t.UMAVOICESOUND_MP3="56_UmaVoiceSound_mp3",t.TOSSHINSOUND_MP3="63_TosshinSound_mp3",t.METALSOUND_MP3="62_MetalSound_mp3",t.METAL6SOUND_MP3="73_Metal6Sound_mp3",t.CARSTARTSOUND_MP3="86_CarStartSound_1_mp3",t.CARPASSSOUND_1_MP3="87_CarPassSound_1_mp3",t.FUSUMAOPENSOUND_MP3="83_FusumaOpenSound_mp3",t.CHAIRSOUND_MP3="105_ChairSound_mp3",t.KONSOUND_MP3="9_KonSound_mp3",t.BUCHISOUND_MP3="30_BuchiSound_mp3",t.CRASH2SOUND_MP3="77_Crash2Sound_mp3",t.WARESOUND_MP3="115_WareSound_mp3",t.BOWLINGGUTTERSOUND_MP3="116_BowlingGutterSound_mp3",t.BOWLINGTHROWSOUND_MP3="117_BowlingThrowSound_mp3",t.DON2SOUND_MP3="118_Don2Sound_mp3",t.CORRECTSOUND_MP3="101_CorrectSound_mp3",t.SHINE3SOUND_MP3="93_Shine3Sound_mp3",t.KUSASOUND_MP3="11_KusaSound_mp3",t.METAL2SOUND_MP3="37_Metal2Sound_mp3",t.DRYERSOUND_MP3="103_DryerSound_mp3",t.HATODOKEISOUND_MP3="16_HatodokeiSound_mp3",t.FUSUMACLOSESOUND_MP3="84_FusumaCloseSound_mp3",t.KACHISOUND_MP3="49_KachiSound_mp3",t.BIRISOUND_MP3="42_BiriSound_mp3",t.OPENSOUND_MP3="45_OpenSound_mp3",t.HIT2SOUND_MP3="79_Hit2Sound_mp3",t.RUNECHOSOUND_MP3="32_RunEchoSound_mp3",t.WATER3SOUND_MP3="13_Water3Sound_mp3",t.UFOSOUND_1_MP3="18_UfoSound_1_mp3",t.KUSAKARIKISOUND_MP3="58_KusakarikiSound_mp3",t.COWSOUND_MP3="76_CowSound_mp3",t.DOGSOUND_MP3="92_DogSound_mp3",t.SCHOOLCHIMESOUND_1_MP3="31_SchoolChimeSound_1_mp3",t.TODANAOPENSOUND_MP3="99_TodanaOpenSound_mp3",t.SLIDEDOORSOUND_MP3="104_SlideDoorSound_mp3",t.KOROGARISOUND_MP3="48_KorogariSound_mp3",t.KOROGARI2SOUND_MP3="46_Korogari2Sound_mp3",t.HORRORSOUND_MP3="94_HorrorSound_mp3",t.KUSAISOUND_MP3="24_KusaiSound_mp3",t.COIN6SOUND_MP3="60_Coin6Sound_mp3",t.INCORRECTSOUND_MP3="75_IncorrectSound_mp3",t.REGISOUND_MP3="97_RegiSound_mp3",t.REGI2SOUND_MP3="102_Regi2Sound_mp3",t.TAMAGOCRASHSOUND_MP3="22_TamagoCrashSound_mp3",t.KARASUSOUND_MP3="71_KarasuSound_mp3",t.BELL3SOUND_MP3="121_Bell3Sound_mp3",t.BELL2SOUND_MP3="122_Bell2Sound_mp3",t}();__reflect(SoundEnum.prototype,"SoundEnum");var StageEnum=function(){function t(){}return t.Stage1="弹出回避",t.Stage2="KO回避",t}();__reflect(StageEnum.prototype,"StageEnum");var StageDispather=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.EventDispatcher);__reflect(StageDispather.prototype,"StageDispather");var StageEvent=function(t){function e(e,i,n,r,s){var a=t.call(this,e,n,r,s)||this;return a.stage=i,a}return __extends(e,t),e.prototype.getStage=function(){return this.stage},e.STAGE_CLEAR="stage_clear",e.STAGE_OPEN="stage_open",e.STAGE_SELECED="stage_seleced",e}(egret.Event);__reflect(StageEvent.prototype,"StageEvent");var MtgBannerView=function(t){function e(e){var i=t.call(this)||this;if(i.touchEnabled=!1,!window.wx||!window.Mtggameadx)return i;var n="mobilebanner",r=i;r.visible=!1,r.firstShow=!0,r.unitid=e.unitid,r.refreshWhenClose=e.refreshWhenClose,r.wallHeaderHeight=40*e.screensize.width/320;var s={position:e.position,appid:e.appid,unitid:e.unitid,sign:e.sign,screensize:e.screensize,engine:"egret",adxtype:n,loadedCallback:function(t){r.imageUrl=t.imageUrl,r.banner=t.banner,r.isReady=!0,r.render(),r.readyFunc&&r.readyFunc({isFromRefresh:!r.firstShow})}};return e.x&&(s.left=e.x),e.y&&(s.top=e.y),e.width&&(s.width=e.width),e.height&&(s.height=e.height),r.initParam=s,window.Mtggameadx.init(r.initParam),i}return __extends(e,t),e.prototype.refresh=function(){this.firstShow=!1,window.Mtggameadx&&window.Mtggameadx.init(this.initParam)},e.prototype.show=function(){var t=arguments[0];if(!t||1!=t.isFromRefresh)return this.isReady?(this.visible=!0,window.Mtggameadx._doOnShow(this.unitid),!0):(this.readyFunc=this.show,!1)},e.prototype.render=function(){if(window.Mtggameadx){this.removeChildren();var t=this,e=new eui.Image;t.banner.bannerImage=e,e.source=t.imageUrl,t.addChild(e),e.width=t.banner.area.endX-t.banner.area.startX,e.height=t.banner.area.endY-t.banner.area.startY,e.x=t.banner.area.startX,e.y=t.banner.area.startY,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t);var i=e.height/10,n=new eui.Group;n.width=3*i,n.height=3*i,n.y=e.y,n.x=0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t);var r=new egret.Shape;r.graphics.beginFill(16777215,1),r.graphics.drawCircle(1.5*i,1.5*i,i),r.graphics.endFill(),r.graphics.beginFill(0,1),r.graphics.drawCircle(1.5*i,1.5*i,4*i/5),r.graphics.endFill();var s=new eui.Label("×");s.textColor=16777215,s.bold=!0,s.fontFamily="arial",s.size=1.5*i,s.horizontalCenter=0,s.verticalCenter=0,n.addChild(r),n.addChild(s),t.addChild(n),console.log("mtgadx show")}},e.prototype.close=function(){var t=this;t.visible=!1,window.Mtggameadx._doOnClose(t.unitid),1==t.refreshWhenClose&&t.refresh()},e.prototype.onClick=function(){window.Mtggameadx&&(window.Mtggameadx._doJumpAction(this.unitid),console.log("mtgadx click"))},e}(egret.Sprite);__reflect(MtgBannerView.prototype,"MtgBannerView");var MtgNativeView=function(t){function e(e){var i=t.call(this)||this;if(i.touchEnabled=!1,!window.wx||!window.Mtggameadx)return i;var n="native",r=i;r.visible=!1,r.firstShow=!0,r.unitid=e.unitid,r.refreshWhenClose=e.refreshWhenClose,r.wallHeaderHeight=40*e.screensize.width/320;var s={position:e.position,appid:e.appid,unitid:e.unitid,sign:e.sign,screensize:e.screensize,engine:"egret",adxtype:n,loadedCallback:function(t){r.bannerData={imageUrl:t.imageUrl,iconUrl:t.iconUrl,title:t.title,desc:t.desc,ctatext:t.ctatext,width:t.width,height:t.height},r.banner=t.banner,r.isReady=!0,r.render(),r.readyFunc&&r.readyFunc({isFromRefresh:!r.firstShow})}};return e.x&&(s.left=e.x),e.y&&(s.top=e.y),e.width&&(s.width=e.width),e.height&&(s.height=e.height),r.initParam=s,window.Mtggameadx.init(r.initParam),i}return __extends(e,t),e.prototype.refresh=function(){this.firstShow=!1,window.Mtggameadx&&window.Mtggameadx.init(this.initParam)},e.prototype.show=function(){var t=arguments[0];if(!t||1!=t.isFromRefresh)return this.isReady?(this.visible=!0,window.Mtggameadx._doOnShow(this.unitid),!0):(this.readyFunc=this.show,!1)},e.prototype.render=function(){if(window.Mtggameadx){this.removeChildren();var t=this,e=new eui.Image;t.banner.bannerImage=e,e.source=t.bannerData.imageUrl,t.addChild(e),e.width=590,e.height=424,e.x=20+(Util.curWidth()-620)/2,e.y=230.35,e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t);var i=new eui.Image;i.source=t.bannerData.iconUrl,t.addChild(i),i.width=60,i.height=60,i.x=30+(Util.curWidth()-435)/2,i.y=665,i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t);var n=new eui.Label(t.bannerData.title);n.textColor=0,n.bold=!1,n.fontFamily="arial",n.size=20,n.x=120+(Util.curWidth()-435)/2,n.y=665,t.addChild(n);var r=new eui.Label(t.bannerData.desc);r.textColor=0,r.bold=!1,r.fontFamily="arial",r.size=24,r.x=120+(Util.curWidth()-435)/2,r.y=695,r.addEventListener(egret.TouchEvent.TOUCH_TAP,t.onClick,t),t.addChild(r),console.log("mtgadx show")}},e.prototype.close=function(){var t=this;t.visible=!1,window.Mtggameadx._doOnClose(t.unitid),1==t.refreshWhenClose&&t.refresh()},e.prototype.onClick=function(){window.Mtggameadx&&(window.Mtggameadx._doJumpAction(this.unitid),console.log("mtgadx click"))},e}(egret.Sprite);__reflect(MtgNativeView.prototype,"MtgNativeView");var MtgWallView=function(t){function e(e){var i=t.call(this)||this,n=i;if(n.visible=!1,n.firstShow=!0,i.touchEnabled=!1,n.unitid=e.unitid,n.refreshWhenClose=e.refreshWhenClose,n.screensize=e.screensize,n.itemHeight=Math.floor(e.screensize.height/9),n.headercolor=e.headercolor||1624143,n.headertextcolor=e.headertextcolor||0,!window.wx||!window.Mtggameadx)return i;var r="offerwall",n=i;n.unitid=e.unitid,n.screensize=e.screensize;var s={position:e.position,appid:e.appid,unitid:e.unitid,sign:e.sign,screensize:e.screensize,engine:"egret",adxtype:r,loadedCallback:function(t){n.bannerArray=t.bannerArray,n.wallTitle=t.icon_t,n.checkIcon(e,t.icon_img),n.render(),n.isReady=!0,n.readyFunc&&n.readyFunc({isFromRefresh:!n.firstShow})}};return n.initParam=s,window.Mtggameadx.init(n.initParam),i}return __extends(e,t),e.prototype.refresh=function(){this.firstShow=!1,window.Mtggameadx&&window.Mtggameadx.init(this.initParam)},e.prototype.checkIcon=function(t,e){var i=this;t.icon&&(i.icon={icon_img:t.icon.icon_img||e,x:t.icon.x||0,y:t.icon.y||0,width:t.icon.width||Math.floor(.7*i.itemHeight),height:t.icon.height||Math.floor(.7*i.itemHeight)})},e.prototype.setIcon=function(t){if(this.icon){t.x&&(this.iconGroup.x=t.x),t.y&&(this.iconGroup.y=t.y);var e=this.iconGroup.getChildAt(0);t.width&&(e.width=t.width),t.height&&(e.height=t.height)}},e.prototype.getWxMenuHearderSize=function(){var t=window.wx.getMenuButtonBoundingClientRect(),e=t?{width:window.screen.availWidth,height:t.bottom+t.top}:{width:360,height:50};return e},e.prototype.render=function(){var t=this;t.removeChildren();var e=t.bannerArray,i=new eui.Group;i.width=t.screensize.width;var n=t.getWxMenuHearderSize();t.wallHeaderHeight=i.width*n.height/n.width,i.height=2*t.wallHeaderHeight,i.x=0,i.y=0;var r=new eui.Rect(i.width,i.height,t.headercolor),s=new eui.Rect(i.width,i.height/2,0),a=t.wallTitle?t.wallTitle:"",o=new eui.Label(a);o.horizontalCenter=0,o.verticalCenter=i.height/4,i.addChild(r),i.addChild(s),i.addChild(o);var h=new eui.Group;h.width=t.screensize.width,h.height=t.screensize.height-i.height,h.y=i.height,h.x=0;var c=new egret.ScrollView;c.width=h.width,c.height=h.height,c.bounces=!0,c.verticalScrollPolicy="on";var l=t.generateItems(e);c.setContent(l);var d=new eui.Rect(l.width,e.length*t.itemHeight,16777215);d.width=l.width,d.height=h.height,h.addChild(d),h.addChild(c);var g=new eui.Group;g.width=t.wallHeaderHeight,g.height=t.wallHeaderHeight,g.y=t.wallHeaderHeight,g.x=t.screensize.width-g.width,g.addEventListener(egret.TouchEvent.TOUCH_TAP,t.close,t);var p=new egret.Shape;p.graphics.beginFill(16777215,1),p.graphics.drawCircle(t.wallHeaderHeight/2,t.wallHeaderHeight/2,1*t.wallHeaderHeight/4),p.graphics.endFill(),p.graphics.beginFill(t.headercolor,1),p.graphics.drawCircle(t.wallHeaderHeight/2,t.wallHeaderHeight/2,1*t.wallHeaderHeight/5),p.graphics.endFill();var u=new eui.Label("×");if(u.textColor=16777215,u.bold=!1,u.fontFamily="arial",u.size=1*t.wallHeaderHeight/3,u.horizontalCenter=0,u.verticalCenter=0,g.addChild(p),g.addChild(u),t.wallGroup=new eui.Group,t.wallGroup.addChild(h),t.wallGroup.addChild(i),t.wallGroup.addChild(g),t.addChild(t.wallGroup),t.icon){t.iconGroup=new eui.Group,t.iconGroup.x=t.icon.x,t.iconGroup.y=t.icon.y;var _=new eui.Image;_.source=t.icon.icon_img,_.width=t.icon.width,_.height=t.icon.height,_.x=0,_.y=0;var f=t.wallTitle?t.wallTitle:"",m=new eui.Label(f);t.wallTitle||(m.visible=!1),m.fontFamily="arial",m.bold=!1,m.textColor=t.headertextcolor,t.wallTitle&&t.wallTitle.length>0&&(m.size=Math.floor(_.width/(1.2*t.wallTitle.length))),m.x=0,m.y=1.05*_.height,m.horizontalCenter=0,t.iconGroup.addChild(_),t.iconGroup.addChild(m),t.iconGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,t.showAll,t),t.wallGroup.visible=!1,t.addChild(t.iconGroup)}else t.wallGroup.visible=!0;console.log("mtgadx show")},e.prototype.generateItems=function(t){var e=this,i=new eui.Group;i.width=e.screensize.width,i.height=0;for(var n=1,r=0,s=t.length;s>r;r++)!function(s){i.height+=e.itemHeight;var a=t[s],o=new eui.Group;o.width=e.screensize.width,o.height=e.itemHeight,o.x=0,o.y=r*e.itemHeight;var h=new eui.Image;h.source=a.localImageUrl;var c=Math.floor(.8*e.itemHeight),l=Math.floor(.1*e.itemHeight);h.width=c,h.height=c,h.x=l,h.y=l;var d=new eui.Group;d.width=e.screensize.width/4,d.height=e.itemHeight,d.y=0,d.x=3*e.screensize.width/4,d.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.onClick(a.offer.id)},e);var g=new egret.Shape;g.graphics.beginFill(6276146,1),g.graphics.drawRoundRect(.1*d.width,e.itemHeight/3,.8*d.width,e.itemHeight/3,e.itemHeight/3,e.itemHeight/3),g.graphics.endFill();var p=a.offer.ctatext,u=new eui.Label(p);u.textColor=16777215,u.bold=!0,u.fontFamily="arial",u.x=0,u.y=0,u.size=3*d.width/(5*p.length),u.horizontalCenter=0,u.verticalCenter=0;var g=new egret.Shape;g.graphics.beginFill(e.headercolor,1),g.graphics.drawRoundRect(.1*d.width,e.itemHeight/3,.8*d.width,e.itemHeight/3,e.itemHeight/3,e.itemHeight/3),g.graphics.endFill();var _=a.offer.title,f=new eui.Label(_);f.bold=!0,f.fontFamily="arial",f.size=Math.floor(.9*f.height);for(var m=3*e.screensize.width/4-e.itemHeight,w=_;f.width>m&&_.length>1;)w=w.substring(0,w.length-1),_=w+"...",f=new eui.Label(_),f.bold=!1,f.fontFamily="arial",f.size=Math.floor(.9*f.height);f.textColor=0,f.x=0,f.y=3*l,f.width=3*e.screensize.width/4-e.screensize.height,f.height=e.itemHeight/2-f.y,f.size=Math.floor(.9*f.height);var S=a.offer.desc,y=new eui.Label(S);y.bold=!1,y.fontFamily="arial",y.size=Math.floor(.7*y.height);for(var v=S;y.width>m&&S.length>1;)v=v.substring(0,v.length-1),S=v+"...",y=new eui.Label(S),y.bold=!1,y.fontFamily="arial",y.size=Math.floor(.7*y.height);y.textColor=12303291,y.x=0,y.y=l+e.itemHeight/2,y.height=f.height;var E=new eui.Group;E.scrollEnabled=!0,E.width=m,E.height=e.itemHeight,E.x=e.itemHeight,E.y=0,E.addChild(f),E.addChild(y);var T=new eui.Rect(o.width,1,14540253);T.width=o.width,T.y=e.itemHeight-n,o.addChild(T),o.addChild(E),o.addChild(h),d.addChild(g),d.addChild(u),o.addChild(d),i.addChild(o)}(r);return i},e.prototype.showAll=function(){return this.isReady?(this.icon?(this.iconGroup.visible=!1,this.wallGroup.visible=!0,this.visible=!0):(this.wallGroup.visible=!0,this.visible=!0),window.Mtggameadx._doOnShow(this.unitid),!0):(this.readyFunc=this.showAll,!1)},e.prototype.close=function(){var t=this;t.icon?(t.wallGroup.visible=!1,t.iconGroup.visible=!0):t.visible=!1,window.Mtggameadx._doOnClose(t.unitid),1==t.refreshWhenClose&&t.refresh()},e.prototype.show=function(){var t=arguments[0];if(!t||1!=t.isFromRefresh)return this.isReady?(this.icon?(this.visible=!0,this.iconGroup.visible=!0,this.wallGroup.visible=!1):(this.visible=!0,this.wallGroup.visible=!0,window.Mtggameadx._doOnShow(this.unitid)),!0):(this.readyFunc=this.show,!1)},e.prototype.closeAll=function(){var t=this;t.visible=!1,window.Mtggameadx._doOnClose(t.unitid)},e.prototype.onClick=function(t){window.Mtggameadx&&(window.Mtggameadx._doJumpAction(this.unitid,t),console.log("mtgadx click"))},e}(egret.Sprite);__reflect(MtgWallView.prototype,"MtgWallView");var AdManager=function(){function t(){this._bannerShow=!1,this._vedioLoaded=!1,this.init()}return t.initMtgBanner=function(){},t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error");this._banner=null,this._vedio=null,this._interstitialAd=null,this.schemeEntrance=new egret.Bitmap,this._interstitialAdTimes=0},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.fetchVedio=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return null!==this._vedio?[3,2]:(t=this,[4,platform.fetchVedio()]);case 1:t._vedio=e.sent(),null!==this._vedio&&(this._vedioLoaded=!0),e.label=2;case 2:return[2]}})})},t.prototype.vedioPlay=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return platform.vedioPlay(this._vedio,t,function(t){var i=t.finish;console.log("视频播放完成"+i),e(i)}),[2]})})},t.prototype.fetchInterstitial=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return null!==this._interstitialAd?[3,2]:(t=this,[4,platform.fetchInterstitial()]);case 1:t._interstitialAd=e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.showInterstitial=function(){platform.hasInterstitialSDK()&&(this._interstitialAdTimes++,console.log(this._interstitialAdTimes),5===this._interstitialAdTimes&&(platform.showInterstitial(this._interstitialAd),this._interstitialAdTimes=0))},t.prototype.fetchAppBox=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return"qqgame"!==platform.name?[3,2]:(t=this,[4,platform.fetchAppBox()]);case 1:t._appBox=e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.showAppBox=function(){"qqgame"===platform.name&&platform.showAppBox(this._appBox)},t.prototype.fetchBanner=function(t){return void 0===t&&(t=!0),__awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return"tt"===platform.name&&"Douyin"===platform.getAppName()?(this.schemeEntrance.texture=RES.getRes("banner_png"),this.schemeEntrance.width=Util.curWidth(),this.schemeEntrance.height=120,this.schemeEntrance.anchorOffsetX=this.schemeEntrance.width/2,this.schemeEntrance.anchorOffsetY=this.schemeEntrance.height,this.schemeEntrance.x=Util.curWidth()/2,this.schemeEntrance.y=Util.curHeight(),this.schemeEntrance.visible=!0,this.schemeEntrance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSchemeTouched,this),[2]):null!==this._banner?[3,2]:(e=this,[4,platform.fetchBanner()]);case 1:e._banner=i.sent(),i.label=2;case 2:return null!==this._banner&&t&&console.log("show old banner"),[2]}})})},t.prototype.showBanner=function(){"tt"===platform.name&&"Douyin"===platform.getAppName()?this.showScheme():null===this._banner||this._bannerShow||(this._bannerShow=!0,platform.showBanner(this._banner))},t.prototype.showScheme=function(){"tt"===platform.name&&((null===this.schemeEntrance||void 0===this.schemeEntrance)&&(this.schemeEntrance.texture=RES.getRes("banner_png"),this.schemeEntrance.width=Util.curWidth(),this.schemeEntrance.height=120,this.schemeEntrance.anchorOffsetX=this.schemeEntrance.width/2,this.schemeEntrance.anchorOffsetY=this.schemeEntrance.height,this.schemeEntrance.x=Util.curWidth()/2,this.schemeEntrance.y=Util.curHeight(),UIManager.getInstance().getMtgAdLayer().addChild(this.schemeEntrance)),this.schemeEntrance.texture=RES.getRes("banner_png"),this.schemeEntrance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSchemeTouched,this),this.schemeEntrance.visible=!0)},t.prototype.hideScheme=function(){"tt"===platform.name&&(this.schemeEntrance.visible=!1,this.schemeEntrance.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onSchemeTouched,this))},t.prototype.hideBanner=function(){"tt"===platform.name&&"Douyin"===platform.getAppName()?this.hideScheme():null!==this._banner&&this._bannerShow&&(this._bannerShow=!1,platform.hideBanner(this._banner),"oppo"!==platform.name&&(this._banner=null,this.fetchBanner(!1)))},Object.defineProperty(t.prototype,"bannerOK",{get:function(){return null===this._banner?!1:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"banner",{get:function(){return this._banner},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vedio",{get:function(){return this._vedio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appBox",{get:function(){return this._appBox},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bannerShow",{get:function(){return this._bannerShow},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"interstitialAd",{get:function(){return this._interstitialAd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vedioOK",{get:function(){return this._vedioLoaded||platform.reloadVedio(this._vedio),this._vedioLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vedioLoaded",{set:function(t){this._vedioLoaded=t},enumerable:!0,configurable:!0}),t.prototype.onSchemeTouched=function(t){platform.openScheme()},t.instance=null,t}();__reflect(AdManager.prototype,"AdManager");var I18nManager=function(){function t(){this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error");this.lang=Config.getInstance().i18n},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.getLanguageInGroupByName=function(t,e){return this.lang[SettingController.getInstance().Lang][t][e]},t.prototype.getLanguageByGroup=function(t){return this.lang[SettingController.getInstance().Lang][t]},t.prototype.getLanguageByName=function(t){return this.lang[SettingController.getInstance().Lang][t]},Object.defineProperty(t.prototype,"language",{get:function(){return this.lang[SettingController.getInstance().Lang]},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(I18nManager.prototype,"I18nManager");var SoundManager=function(){function t(){this.bgmPlaying=!1,this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error")},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.playBGM=function(){if(SettingController.getInstance().SoundPlaying&&!this.bgmPlaying){if(this.bgm=RES.getRes(SoundEnum.MAIN1SOUND_1_MP3),void 0===this.bgm)return;this.bgmChannel=this.bgm.play(0,0),this.bgmPlaying=!0}},t.prototype.playSound=function(t,e){if(void 0===e&&(e=1),SettingController.getInstance().SoundPlaying){var i=RES.getRes(t);this.soundChannel=i.play(0,e)}},t.prototype.onPlayOver=function(){},t.prototype.stopBGM=function(){this.bgmPlaying&&(this.bgmChannel.stop(),this.bgmPlaying=!1),void 0!==this.soundChannel&&this.soundChannel.stop()},t.instance=null,t}();__reflect(SoundManager.prototype,"SoundManager");var UIManager=function(){function t(){this.mtgAdLayer=new egret.DisplayObjectContainer,this.gameLayer=new egret.DisplayObjectContainer,this.loadingLayer=new egret.DisplayObjectContainer,this.uiLayer=new egret.DisplayObjectContainer,this.popLayer=new egret.DisplayObjectContainer,this.tipLayer=new egret.DisplayObjectContainer,this.gameScene=null,this.titleScene=null,this.dataScene=null,this.rankScene=null,this.isPopUp=!1,this.currentScene=null}return t.prototype.init=function(t){this.egretStage=t,this.loading=new LoadingUI,this.initLayer(this.gameLayer),this.initLayer(this.uiLayer),this.egretStage.addChild(this.popLayer),this.egretStage.addChild(this.tipLayer),this.egretStage.addChild(this.loadingLayer),this.egretStage.addChild(this.mtgAdLayer),this.egretStage.scaleMode===egret.StageScaleMode.FIXED_WIDTH},t.prototype.setSheet=function(){},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.initLayer=function(t){t.x=(Util.curWidth()-Util.displayWidth())/2,t.y=(Util.curHeight()-Util.displayHeight())/2,this.egretStage.addChild(t)},t.prototype.getGameLayer=function(){return this.gameLayer},t.prototype.getUILayer=function(){return this.uiLayer},t.prototype.getLoadingLayer=function(){return this.loadingLayer},t.prototype.getMtgAdLayer=function(){return this.mtgAdLayer},t.prototype.getPopLayer=function(){return this.popLayer},t.prototype.getTipLayer=function(){return this.tipLayer},t.prototype.setCurrentPop=function(t){this.currentPop=t},t.prototype.getCurrentPop=function(){return this.currentPop},t.prototype.getCurrentStage=function(){return this.currentStage},t.prototype.toRankScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.showLoading(),[4,RES.loadGroup("data_scene")];case 1:return t.sent(),[4,RES.loadGroup("game_scene")];case 2:return t.sent(),null!==this.currentScene&&(this.currentScene.parent===this.gameLayer&&this.gameLayer.removeChild(this.currentScene),this.currentScene!==this.rankScene&&this.uiLayer.removeChildren(),this.currentScene=null),null===this.rankScene&&(this.rankScene=new RankScene(this.egretStage)),this.currentScene=this.rankScene,this.gameLayer.addChild(this.currentScene),this.hideLoading(!1),[2]}})})},t.prototype.toTitleScene=function(){this.showLoading(),null!==this.currentScene&&(this.gameLayer.removeChildren(),this.currentScene!==this.titleScene&&this.uiLayer.removeChildren()),null===this.titleScene&&(this.titleScene=new TitleScene(this.egretStage)),this.currentScene=this.titleScene,this.gameLayer.addChild(this.currentScene),this.hideLoading(!1)
},t.prototype.toGameScene=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return this.showLoading(!0),[4,RES.loadGroup("game_scene")];case 1:return e.sent(),[4,RES.loadGroup("tip")];case 2:return e.sent(),null!==this.currentScene&&this.currentScene!==this.gameScene&&(this.gameLayer.removeChildren(),this.uiLayer.removeChildren()),t=this,[4,new GameScene(this.egretStage)];case 3:return t.gameScene=e.sent(),this.currentScene=this.gameScene,this.currentScene.setGameStage(),this.gameLayer.addChild(this.currentScene),[2]}})})},t.prototype.toDataScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.showLoading(),[4,RES.loadGroup("data_scene")];case 1:return t.sent(),[4,RES.loadGroup("game_scene")];case 2:return t.sent(),null!==this.currentScene&&(this.gameLayer.removeChildren(),this.currentScene!==this.dataScene&&this.uiLayer.removeChildren(),this.currentScene=null),null===this.dataScene&&(this.dataScene=new DataScene(this.egretStage)),this.currentScene=null,this.currentScene=this.dataScene,this.gameLayer.addChild(this.currentScene),this.hideLoading(!1),[2]}})})},t.prototype.showLoading=function(t){void 0===t&&(t=!1),this.loading.showStage(t),this.loadingLayer.addChild(this.loading),this.loading.onShow()},t.prototype.hideLoading=function(t){void 0===t&&(t=!0),this.loading.parent===this.loadingLayer&&(this.loading.onHide(),this.loadingLayer.removeChild(this.loading)),t&&platform.startRecord()},t.prototype.openHowToPlayPop=function(){var t=new HowToPlayPop;this.popLayer.addChild(t),this.isPopUp=!0,this.currentPop=t},t.prototype.closeHowToPlayPop=function(){this.popLayer.removeChild(this.currentPop),this.isPopUp=!1,this.currentPop=null},t.prototype.openItemGetPop=function(t){null==this.itemGetPop&&(this.itemGetPop=new ItemGetPop,this.itemGetPop.setIcon(t),PopEffect.addPopUp(this.itemGetPop,!0,0,0,2),this.isPopUp=!0,this.currentPop=this.itemGetPop)},t.prototype.closeItemGetPop=function(){null!=this.itemGetPop&&(PopEffect.removePopUp(this.itemGetPop,1),this.itemGetPop=null,this.isPopUp=!1,this.currentPop=null)},t.prototype.openMenuPop=function(){null==this.menuPop&&(this.menuPop=new MenuPop,this.popLayer.addChild(this.menuPop),this.isPopUp=!0,this.currentPop=this.menuPop)},t.prototype.closeMenuPop=function(){null!=this.menuPop&&(this.popLayer.removeChild(this.menuPop),this.menuPop=null,this.currentPop=null,this.isPopUp=!1)},t.prototype.openClearPop=function(e,i,n){this.closeAllPop(),null==this.clearPop&&(this.clearPop=new ClearPop(e,n),t.getInstance().getPopLayer().addChild(this.clearPop),this.currentPop=this.clearPop,this.isPopUp=!0,AdManager.getInstance().showBanner())},t.prototype.closeClearPop=function(){null!=this.clearPop&&(t.getInstance().getPopLayer().removeChild(this.clearPop),this.clearPop=null,this.currentPop=null,this.isPopUp=!1)},t.prototype.openGameOverPop=function(e,i,n){this.closeAllPop(),null==this.gameOverPop&&(this.gameOverPop=new GameOverPop(e,n),t.getInstance().getPopLayer().addChild(this.gameOverPop),this.currentPop=this.gameOverPop,this.isPopUp=!0,AdManager.getInstance().showBanner())},t.prototype.closeGameOverPop=function(){null!=this.gameOverPop&&(t.getInstance().getPopLayer().removeChild(this.gameOverPop),this.gameOverPop=null,this.currentPop=null,this.isPopUp=!1)},t.prototype.openCardPop=function(t,e){void 0===e&&(e=0),null==this.cardPop&&(this.cardPop=new CardPop(t,e),this.popLayer.addChild(this.cardPop))},t.prototype.closeCardPop=function(){null!=this.cardPop&&(this.popLayer.removeChild(this.cardPop),this.cardPop=null)},t.prototype.openCollectionHintPop=function(t,e){null==this.collectionHintPop&&(this.collectionHintPop=new CollectionHintPop(t,e),this.popLayer.addChild(this.collectionHintPop))},t.prototype.closeCollectionHintPop=function(){null!=this.collectionHintPop&&(this.popLayer.removeChild(this.collectionHintPop),this.collectionHintPop=null)},t.prototype.openJumpStagePop=function(){null==this.jumpStagePop&&(this.jumpStagePop=new JumpStagePop,this.popLayer.addChild(this.jumpStagePop))},t.prototype.closeJumpStagePop=function(){null!=this.jumpStagePop&&(this.popLayer.removeChild(this.jumpStagePop),this.jumpStagePop=null)},t.prototype.openHintPop=function(t,e){void 0===e&&(e=!1),null==this.hintPop&&(this.hintPop=new HintPop(t),this.popLayer.addChild(this.hintPop))},t.prototype.closeHintPop=function(){null!=this.hintPop&&(this.popLayer.removeChild(this.hintPop),this.hintPop=null)},t.prototype.openNoVedioPop=function(){null==this.noVedioPop&&(this.noVedioPop=new NoVedioPop,this.popLayer.addChild(this.noVedioPop))},t.prototype.closeNoVedioPop=function(){null!=this.noVedioPop&&(this.popLayer.removeChild(this.noVedioPop),this.noVedioPop=null)},t.prototype.openStageTitlePop=function(){null==this.stageTitlePop&&(this.stageTitlePop=new StageTitlePop,t.getInstance().getPopLayer().addChild(this.stageTitlePop),this.currentPop=this.stageTitlePop,this.isPopUp=!0)},t.prototype.closeStageTitlePop=function(){null!=this.stageTitlePop&&(t.getInstance().getPopLayer().removeChild(this.stageTitlePop),this.currentPop=null,this.stageTitlePop=null,this.isPopUp=!1)},t.prototype.closeAllPop=function(){this.closeItemGetPop(),this.closeMenuPop(),this.closeClearPop(),this.closeGameOverPop(),this.closeMenuPop(),this.closeHintPop()},t.prototype.showItemFullTip=function(){void 0===this.itemFullTip&&(this.itemFullTip=new TSBitmap("itemfull_png"),this.itemFullTip.alpha=0,this.itemFullTip.x=Util.curWidth()/2,this.itemFullTip.y=Util.curHeight()/2,this.itemFullTip.anchorOffsetX=this.itemFullTip.width/2,this.itemFullTip.anchorOffsetY=this.itemFullTip.height/2,this.tipLayer.addChild(this.itemFullTip)),this.itemFullTip.alpha>0||(this.itemFullTip.alpha=1,egret.Tween.get(this.itemFullTip).wait(1500).to({alpha:0},500).call(function(){}))},t.instance=null,t}();__reflect(UIManager.prototype,"UIManager");var Config=function(){function t(){this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error")},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},Object.defineProperty(t.prototype,"i18n",{get:function(){return void 0===this._i18n&&(this._i18n=RES.getRes("i18n_json")),this._i18n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"select_json",{get:function(){return void 0===this._select_json&&(this._select_json=RES.getRes("select_json")),this._select_json},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"card_tip",{get:function(){return void 0===this._card_tip&&(this._card_tip=RES.getRes("card_tip_json")),this._card_tip},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(Config.prototype,"Config");var SaveData=function(){function t(){this._isNewPlayer=!0,this._isTipGot=!1,this._isTipUsed=!1,this.init()}return t.prototype.init=function(){if(null!==t.instance)throw new Error("single instance error");this.cardConfig=Config.getInstance().card_tip;var e=egret.localStorage.getItem("userSave");if(null===e||void 0===e||""===e){this.cardSave=[null];for(var i=0;143>i;i++)this.cardSave.push(0);this.stageSave=[null,0],this.saveData={stageSave:this.stageSave,cardSave:this.cardSave,guide:"0",tip:"0"},this.saveUserData()}else this.saveData=JSON.parse(e),this.stageSave=this.saveData.stageSave,this.cardSave=this.saveData.cardSave,this._isNewPlayer="0"===this.saveData.guide?!0:!1,(null===this.saveData.tip||void 0===this.saveData.tip)&&(this.saveData.tip="0"),this._isTipGot="0"===this.saveData.tip?!1:!0,this._isTipUsed="2"===this.saveData.tip?!0:!1,console.log(this._isTipGot),console.log(this._isTipUsed)},t.getInstance=function(){return null===this.instance&&(this.instance=new t),this.instance},t.prototype.saveUserData=function(){var t;t=this._isTipGot===!1?"0":this._isTipUsed===!0?"2":"1",console.log(t),this.saveData={stageSave:this.stageSave,cardSave:this.cardSave,guide:this._isNewPlayer?"0":"1",tip:t},egret.localStorage.setItem("userSave",JSON.stringify(this.saveData))},t.prototype.getStageOpen=function(){return this.stageSave.length-1},t.prototype.getDataSceneOpen=function(){return this.cardSave.length-1===0?!1:!0},t.prototype.saveStagePass=function(t){if(this.stageSave[t]<4){this.stageSave[t]+=4,1===t?(this.stageSave.push(0),this.stageSave.push(0),this.stageSave.push(0),this.stageSave.push(0),this.stageSave.push(0)):this.stageSave.length<31&&this.stageSave.push(0);this.getStageOpen();return this.saveUserData(),!0}return!1},t.prototype.passGuide=function(){this._isNewPlayer=!1,this.saveUserData()},t.prototype.saveStageHintRead=function(t){this.stageSave[t]+=1,this.saveUserData()},t.prototype.getStageStatus=function(t){var e={pass:!1,hint:0},i=this.stageSave[t]-4;return e.pass=i>=0?!0:!1,e.hint=i>=0?i:this.stageSave[t],e},t.prototype.getStageSave=function(){return this.stageSave},t.prototype.saveCardHintRead=function(t){0===this.cardSave[t]&&(this.cardSave[t]=1,this.saveUserData())},t.prototype.saveCardGot=function(t){void 0===this.cardSave&&(this.cardSave=[null]),this.cardSave[t]=3,this.saveUserData()},t.prototype.getCardStatus=function(t){return void 0===this.cardSave&&(this.cardSave=[null]),this.cardSave.length<t?0:this.cardSave[t]},t.prototype.saveSoundStatus=function(t){egret.localStorage.setItem("soundPlaying",t)},t.prototype.getSoundStatus=function(){return egret.localStorage.getItem("soundPlaying")},t.prototype.getLang=function(){return egret.localStorage.getItem("lang")},t.prototype.setLang=function(t){egret.localStorage.setItem("lang",t)},t.prototype.getLastPlay=function(){var t=egret.localStorage.getItem("lastPlay");return null===t||void 0===t||""===t?1:parseInt(t)},t.prototype.saveLastPlay=function(t){egret.localStorage.setItem("lastPlay",t)},Object.defineProperty(t.prototype,"isNewPlayer",{get:function(){return this._isNewPlayer},enumerable:!0,configurable:!0}),t.prototype.saveTip=function(e){console.log(e),1===e?t.getInstance()._isTipGot?platform.showTip("分享成功"):(this._isTipGot=!0,this._isTipUsed=!1,platform.showTip("分享成功，\n您获得一条免费提示")):2===e&&t.getInstance()._isTipUsed===!1&&(this._isTipGot=!0,this._isTipUsed=!0),this.saveUserData()},Object.defineProperty(t.prototype,"isTipGot",{get:function(){return this._isTipGot},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isTipUsed",{get:function(){return this._isTipUsed},enumerable:!0,configurable:!0}),t.instance=null,t}();__reflect(SaveData.prototype,"SaveData");var DebugPlatform=function(){function t(){}return t.prototype.initSDK=function(){},t.prototype.initAnalytics=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{gameKey:"02a2d376f1268780cdeb969e3385bae2",secretKey:"9b426779362d3259747c55f90ce0a40500524bcb"}]})})},t.prototype.analytics=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return console.log(t,e),[2]})})},t.prototype.setLifeCycleCallBack=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return egret.lifecycle.onPause=function(){t()},egret.lifecycle.onResume=function(){e()},[2]})})},t.prototype.setLoadingProgress=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.loadingComplete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.print=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log(t),[2]})})},t.prototype.existRank=function(){return!1},t.prototype.getRank=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,e){console.log("获取"),t([{nick:"哈N她!)|A(1",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)A(2",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(3",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(4",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(5",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(6",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(7",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(8",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(9",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(10",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(11",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(12",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(13",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"},{nick:"哈N她!)|A(14",score:5,selfFlag:1,url:"http://thirdqq.qlogo.cn/g?b=sdk&k=F7aCnicxWzpicK89d0gkh7cw&s=100&t=1516260478"}])})]})})},t.prototype.share=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log(t),[2]})})},t.prototype.uploadRank=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,e]})})},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.offsetHead=function(){return 0},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchBanner=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.showBanner=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.hideBanner=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchAppBox=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.showAppBox=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchInterstitial=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.showInterstitial=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.fetchVedio=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t.prototype.reloadVedio=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.vedioPlay=function(t,e,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return i(!0),[2]})})},t.prototype.getSaveData=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{key:"key"}]})})},t.prototype.setSaveData=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.rankView=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return UIManager.getInstance().toRankScene(),[2]})})},t.prototype.getGameRecorderManager=function(){return null},t.prototype.shareVedio=function(t){},t.prototype.showTip=function(t){},t.prototype.stopRecord=function(){},t.prototype.pauseRecord=function(){},t.prototype.resumeRecord=function(){},t.prototype.startRecord=function(){},t.prototype.loadNextStage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.loadFont=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getAppName=function(){return""},t.prototype.getLaunchOption=function(){return{}},t.prototype.hasBannerSDK=function(){return!1},t.prototype.hasInterstitialSDK=function(){return!1},t.prototype.hasVedioSDK=function(){return!1},t.prototype.hasShareSDK=function(){return!1},t.prototype.hasShareVedioSDK=function(){return!1},t.prototype.openScheme=function(){},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform,window.platform.name="web");var ClearPop=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;return n.cardGot=[],n.stageId=e,n.popViewRes=i,n.initView(),n}return __extends(e,t),e.prototype.initView=function(){if(this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.resultPic=new TSBitmap(this.popViewRes),this.resultPic.x=Util.curWidth()/2-this.resultPic.width/2,this.resultPic.y=100,this.addChild(this.resultPic),this.retry=new TSBitmap("retryBtn_cn_new_png",null,!0),this.retry.x=Util.curWidth()/4-40,this.retry.y=Util.curHeight()/2,this.retry.touchEnabled=!0,this.addChild(this.retry),this.other=new TSBitmap("chooseStageBtn_png",null,!0),this.other.x=Util.curWidth()/2-10,this.other.y=Util.curHeight()/2,this.other.touchEnabled=!0,this.addChild(this.other),this.next=new TSBitmap("nextStageBtn_cn_new_png",null,!0),this.next.x=3*Util.curWidth()/4+40,this.next.y=Util.curHeight()/2,this.next.touchEnabled=!0,this.addChild(this.next),this.share=new TSBitmap("share",null,!0),this.share.x=320,this.share.y="wxgame"===platform.name?796:776,this.share.touchEnabled=!0,this.share.visible=!platform.hasShareVedioSDK()&&platform.hasShareSDK(),this.addChild(this.share),this.shareVedio=new egret.Bitmap,console.log(SaveData.getInstance().isTipGot),"tt"!==platform.name||SaveData.getInstance().isTipGot?this.shareVedio.texture=RES.getRes("share_vedio"):this.shareVedio.texture=RES.getRes("tip_share_vedio"),this.shareVedio.anchorOffsetX=this.shareVedio.width/2,this.shareVedio.anchorOffsetY=this.shareVedio.height/2,this.shareVedio.x=320,"tt"===platform.name){var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRoundRect(50,420.35,540,150,20,20),t.graphics.endFill(),this.addChild(t);var e=new egret.TextField;e.x=100,e.y=440,e.width=440,e.multiline=!0,e.text="参与#神回避3 话题活动赢好礼",this.addChild(e),this.shareVedio.y=630-this.shareVedio.height-50}else this.shareVedio.y=776;this.shareVedio.touchEnabled=!0,this.shareVedio.visible=platform.hasShareVedioSDK(),this.addChild(this.shareVedio),"wxgame"===platform.name&&(this.advertisement=new egret.Bitmap,this.advertisement.texture=RES.getRes("board_png"),this.advertisement.touchEnabled=!1,this.advertisement.scaleX=630/435,this.advertisement.scaleY=630/435,this.advertisement.x=(Util.curWidth()-620)/2,this.advertisement.y=220.35,this.addChild(this.advertisement),this.advertisement.addEventListener(egret.TouchEvent.TOUCH_TAP,this.advertisementTouched,this)),this.collections=new egret.Sprite,this.collections.y=520.35,this.addChild(this.collections),this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.retryTouched,this),this.share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareTouched,this),this.shareVedio.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareVedioTouched,this),this.other.addEventListener(egret.TouchEvent.TOUCH_TAP,this.otherTouched,this),this.next.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nextTouched,this),"wxgame"===platform.name,this.x=Util.x_fix()},e.prototype.retryTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeClearPop(),UIManager.getInstance().currentScene.onClear(),UIManager.getInstance().toGameScene()},e.prototype.shareVedioTouched=function(){"tt"===platform.name&&platform.shareVedio(function(){console.log("share success"),SaveData.getInstance().saveTip(1)})},e.prototype.shareTouched=function(){"tt"===platform.name?platform.shareVedio(function(){SaveData.getInstance().saveTip(1)}):platform.share("一起回避生活中的尴尬事吧","https://cdn.joypac.cn/kaihi_h5_res/share.jpg")},e.prototype.nextTouched=function(t){UIManager.getInstance().closeAllPop(),StageController.getInstance().setSelect(this.stageId+1)},e.prototype.otherTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeClearPop(),UIManager.getInstance().showLoading(),UIManager.getInstance().currentScene.onClear(),UIManager.getInstance().toTitleScene()},e.prototype.cardViewTouched=function(t){},e.prototype.advertisementTouched=function(){this.destroy()},e.prototype.destroy=function(){this.newSign&&this.collections.contains(this.newSign)&&egret.Tween.removeTweens(this.newSign)},e.prototype.setCollections=function(t){if(void 0===t&&(t=[]),t.length>0){this.cardGot=t;var e=void 0,i=RES.getRes("data_scene");Config.getInstance().card_tip;e=new CardView(i,t[0]),e.x=320,e.touchEnabled=!0,this.collections.addChild(e);var n=new TSBitmap("circle",RES.getRes("pops_sheet"),!0);n.x=261.75,n.y=63.4,this.collections.addChild(n);var r=new egret.TextField;r.text=""+t.length,r.x=n.x-r.width/2,r.y=n.y-r.height/2,r.textColor=0,this.collections.addChild(r),this.newSign=new TSBitmap("new",RES.getRes("pops_sheet"),!0),this.newSign.x=391,this.newSign.y=-56.5,this.collections.addChild(this.newSign),egret.Tween.get(this.newSign,{loop:!0}).to({y:-76.5},800).to({y:-56.5},800),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cardViewTouched,this)}},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(ClearPop.prototype,"ClearPop",["PopBase"]);var CollectionHintPop=function(t){function e(e,i){var n=t.call(this)||this;return n.cardId=e.No,n.getRes(),n}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("tip_sheet")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.bg_view=new TSBitmap("bg0",this.sheet),this.bg_view.x=Util.curWidth()/2-this.bg_view.width/2,this.bg_view.y=Util.curHeight()/2-this.bg_view.height/2,this.addChild(this.bg_view),this.chance_text=new egret.TextField,this.chance_text.text="您有一次免费观看提示的机会",this.chance_text.textColor=0,this.chance_text.x=this.bg_view.x+50,this.chance_text.y=this.bg_view.y+this.bg_view.height/2-80,this.chance_text.visible=SaveData.getInstance().isTipGot&&!SaveData.getInstance().isTipUsed,this.addChild(this.chance_text),this.hint=new HintItem(HintTypeEnum.COLLECTION_HINT_ITEM,this.cardId),this.hint.x=this.bg_view.x+this.bg_view.width/2,this.hint.y=this.bg_view.y+this.bg_view.height/2+40,this.hint.touchEnabled=!0,this.hint.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hintTouched,this),this.addChild(this.hint),this.close_btn=new TSBitmap("close_btn",this.sheet),this.close_btn.x=this.bg_view.x+this.bg_view.width/2-this.close_btn.width/2+252.6,this.close_btn.y=this.bg_view.y+this.bg_view.height/2-this.close_btn.height/2-156.25,this.addChild(this.close_btn),this.close_btn.touchEnabled=!0,this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTouched,this),this.updateView()},e.prototype.hintTouched=function(t){var e=t.target;e.isShow||(SaveData.getInstance().isTipGot&&!SaveData.getInstance().isTipUsed?(HintController.getInstance().setCardHintStatus(this.cardId),this.updateView(),this.chance_text.text="",SaveData.getInstance().saveTip(2)):AdManager.getInstance().vedioOK?this.seeVedio():UIManager.getInstance().openNoVedioPop())},e.prototype.closeTouched=function(t){this.destroy(),UIManager.getInstance().closeCollectionHintPop()},e.prototype.destroy=function(){},e.prototype.seeVedio=function(){AdManager.getInstance().vedioPlay(function(){SoundManager.getInstance().stopBGM()}.bind(this),function(t){SoundManager.getInstance().playBGM(),t&&(HintController.getInstance().setCardHintStatus(this.cardId),this.updateView(),GameAnalyticsController.getInstance().cardVedioPlayAnalytics(this.cardId))}.bind(this))},e.prototype.updateView=function(){var t=SaveData.getInstance().getCardStatus(this.cardId);t>0?this.hint.updateHintShow(!0):this.hint.updateHintShow(!1)},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(CollectionHintPop.prototype,"CollectionHintPop",["PopBase"]);var GameOverPop=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;return n.cardGot=[],n.stageId=e,n.popViewRes=i,n.initView(),n}return __extends(e,t),e.prototype.initView=function(){if(this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.resultPic=new TSBitmap(this.popViewRes),this.resultPic.x=Util.curWidth()/2-this.resultPic.width/2,this.resultPic.y=100,this.addChild(this.resultPic),this.retry=new TSBitmap("retryBtn_cn_new_png",null,!0),this.retry.x=Util.curWidth()/4,this.retry.y=Util.curHeight()/2,this.retry.touchEnabled=!0,this.addChild(this.retry),this.other=new TSBitmap("chooseStageBtn_png",null,!0),this.other.x=3*Util.curWidth()/4,this.other.y=Util.curHeight()/2,this.other.touchEnabled=!0,this.help_btn=new TSBitmap("hintBtn_inResult_cn_png",null,!0),this.help_btn.x=3*Util.curWidth()/4-50,this.help_btn.y=Util.curHeight()/2,this.help_btn.touchEnabled=!0,this.addChild(this.help_btn),egret.Tween.get(this.help_btn,{loop:!0}).to({scaleX:1.2,scaleY:1.2},500).to({scaleX:1,scaleY:1},500),this.hintPop=new HintPop(this.stageId),this.hintPop.anchorOffsetX=this.hintPop.width/2,this.hintPop.anchorOffsetY=this.hintPop.height/2,this.hintPop.x=320,this.hintPop.y=521.35,this.shareVedio=new egret.Bitmap,"tt"!==platform.name||SaveData.getInstance().isTipGot?this.shareVedio.texture=RES.getRes("share_vedio"):this.shareVedio.texture=RES.getRes("tip_share_vedio"),this.shareVedio.anchorOffsetX=this.shareVedio.width/2,this.shareVedio.anchorOffsetY=this.shareVedio.height/2,this.shareVedio.x=320,"tt"===platform.name){var t=new egret.Shape;t.graphics.beginFill(0,.5),t.graphics.drawRoundRect(50,420.35,540,150,20,20),t.graphics.endFill(),this.addChild(t);var e=new egret.TextField;e.x=100,e.y=440,e.width=440,e.multiline=!0,e.text="参与#神回避3 话题活动赢好礼",this.addChild(e),this.shareVedio.y=630-this.shareVedio.height-50}else this.shareVedio.y=776;this.shareVedio.touchEnabled=!0,this.shareVedio.visible=platform.hasShareVedioSDK(),this.addChild(this.shareVedio),"wxgame"===platform.name&&(this.advertisement=new egret.Bitmap,this.advertisement.texture=RES.getRes("board_png"),this.advertisement.touchEnabled=!1,this.advertisement.scaleX=630/435,this.advertisement.scaleY=630/435,this.advertisement.x=(Util.curWidth()-620)/2,this.advertisement.y=220.35,this.addChild(this.advertisement),this.advertisement.addEventListener(egret.TouchEvent.TOUCH_TAP,this.advertisementTouched,this)),this.collections=new egret.Sprite,this.collections.y=520.35,this.addChild(this.collections),this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.retryTouched,this),this.shareVedio.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareVedioTouched,this),this.other.addEventListener(egret.TouchEvent.TOUCH_TAP,this.otherTouched,this),this.help_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.helpTouched,this),"wxgame"===platform.name,this.x=Util.x_fix()},e.prototype.helpTouched=function(){UIManager.getInstance().openHintPop(this.stageId,!0)},e.prototype.retryTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeGameOverPop(),UIManager.getInstance().currentScene.onGameOver(),UIManager.getInstance().toGameScene()},e.prototype.shareVedioTouched=function(){"tt"===platform.name&&platform.shareVedio(function(){SaveData.getInstance().saveTip(1)})},e.prototype.otherTouched=function(){this.destroy(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().closeGameOverPop(),UIManager.getInstance().currentScene.onGameOver(),UIManager.getInstance().toTitleScene()},e.prototype.advertisementTouched=function(){},e.prototype.cardViewTouched=function(t){UIManager.getInstance().openCardPop(this.cardGot)},e.prototype.destroy=function(){this.newSign&&this.collections.contains(this.newSign)&&egret.Tween.removeTweens(this.newSign)},e.prototype.setCollections=function(t){if(void 0===t&&(t=[]),t.length>0){this.cardGot=t;var e=void 0,i=RES.getRes("data_scene");e=new CardView(i,t[0]),e.x=320,e.touchEnabled=!0,this.collections.addChild(e);var n=new TSBitmap("circle",RES.getRes("pops_sheet"),!0);n.x=261.75,n.y=63.4,this.collections.addChild(n);var r=new egret.TextField;r.text=""+t.length,r.x=n.x-r.width/2,r.y=n.y-r.height/2,r.textColor=0,this.collections.addChild(r),this.newSign=new TSBitmap("new",RES.getRes("pops_sheet"),!0),this.newSign.x=391,this.newSign.y=-56.5,this.collections.addChild(this.newSign),egret.Tween.get(this.newSign,{loop:!0}).to({y:-76.5},800).to({y:-56.5},800),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cardViewTouched,this)}},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(GameOverPop.prototype,"GameOverPop",["PopBase"]);var HintItem=function(t){function e(e,i){var n=t.call(this)||this;return n.hintShow=!0,n.type=e,n.id=i,n.initView(),n}return __extends(e,t),e.prototype.initView=function(){var t;this.hintText=new egret.TextField;var e=new egret.TextField;if(this.type===HintTypeEnum.COLLECTION_HINT_ITEM){var i=Config.getInstance().card_tip[this.id];t=new TSBitmap("hintLog_png",null,!0),this.hintText.x=-215,this.hintText.width=434.7,e.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.STAGE_NO).replace("$d",i.stage),this.hintText.text=I18nManager.getInstance().getLanguageInGroupByName(LanguageEnum.GROUP_CARD,this.id).tip}else t=new TSBitmap("hintLog_png",null,!0),this.hintText.x=-185.6,this.hintText.width=396.75,e.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.HINT_TITLE).replace("$d",this.type>0?this.type:""),this.hintText.text=HintController.getInstance().Hints[this.type-1];t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,this.addChild(t),e.textAlign=egret.HorizontalAlign.CENTER,e.x=-102.65,e.y=-59.25,e.width=205.35,e.height=30.85,e.size=24,e.textColor=0,this.addChild(e),this.hintText.y=-29.65,this.hintText.height=95.15,this.hintText.size=26,this.hintText.textColor=0,this.addChild(this.hintText),this.vedioButton=new TSBitmap("viewHint_pic_cn_png",null,!0),this.vedioButton.anchorOffsetX=this.vedioButton.width/2,this.vedioButton.anchorOffsetY=this.vedioButton.height/2,this.vedioButton.visible=!this.hintShow,this.addChild(this.vedioButton),this.touchEnabled=!0
},Object.defineProperty(e.prototype,"hintType",{get:function(){return this.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShow",{get:function(){return this.hintShow},enumerable:!0,configurable:!0}),e.prototype.updateHintShow=function(t){this.hintShow=t,this.vedioButton.visible=!t},Object.defineProperty(e.prototype,"hintId",{get:function(){return this.id},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(HintItem.prototype,"HintItem");var HintPop=function(t){function e(e){var i=t.call(this)||this;return i.stageId=e,i.getRes(),i}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.initView(),[2]})})},e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.bg_view=new TSBitmap("hintFrame_png"),this.bg_view.x=Util.curWidth()/2-this.bg_view.width/2,this.bg_view.y=Util.curHeight()/2-this.bg_view.height/2,this.addChild(this.bg_view),this.chance_text=new egret.TextField,this.chance_text.text="您有一次免费观看提示的机会",this.chance_text.textColor=0,this.chance_text.x=this.bg_view.x+50,this.chance_text.y=this.bg_view.y+this.bg_view.height/2-250,this.chance_text.visible=SaveData.getInstance().isTipGot&&!SaveData.getInstance().isTipUsed,this.addChild(this.chance_text);var t=[-182.75,11.25,185.65],e=HintController.getInstance().Hints;this.hintList=[];for(var i,n=1;n<=e.length;n++)i=new HintItem(n,this.stageId),i.x=this.bg_view.x+this.bg_view.width/2,i.y=this.bg_view.y+this.bg_view.height/2+t[n-1],i.touchEnabled=!0,i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.hintTouched,this),this.hintList.push(i),this.addChild(i);this.close_btn=new TSBitmap("cancel_png"),this.close_btn.x=this.bg_view.x+this.bg_view.width/2-this.close_btn.width/2+292.6,this.close_btn.y=this.bg_view.y+this.bg_view.height/2-this.close_btn.height/2-365.5,this.addChild(this.close_btn),this.close_btn.touchEnabled=!0,this.close_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeTouched,this),this.updateView()},e.prototype.hintTouched=function(t){var e=t.target;e.isShow||(SaveData.getInstance().isTipGot&&!SaveData.getInstance().isTipUsed?(HintController.getInstance().setStageHintStatus(this.stageId),this.updateView(),this.chance_text.text="",SaveData.getInstance().saveTip(2)):AdManager.getInstance().vedioOK?this.seeVedio(t.hintId):UIManager.getInstance().openNoVedioPop())},e.prototype.closeTouched=function(t){this.destroy(),UIManager.getInstance().closeHintPop()},e.prototype.destroy=function(){},e.prototype.seeVedio=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return AdManager.getInstance().vedioPlay(function(){SoundManager.getInstance().stopBGM()}.bind(this),function(e){SoundManager.getInstance().playBGM(),e&&(HintController.getInstance().setStageHintStatus(this.stageId),this.updateView(),GameAnalyticsController.getInstance().stageVedioPlayAnalytics(this.stageId,t))}.bind(this)),[2]})})},e.prototype.updateView=function(){for(var t=SaveData.getInstance().getStageStatus(this.stageId),e=0;e<this.hintList.length;e++)this.hintList[e].hintType<=t.hint?(this.hintList[e].visible=!0,this.hintList[e].updateHintShow(!0)):this.hintList[e].hintType===t.hint+1&&(this.hintList[e].visible=!0,this.hintList[e].updateHintShow(!1))},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(HintPop.prototype,"HintPop",["PopBase"]);var HowToPlayPop=function(t){function e(){var e=t.call(this)||this;return e.getRes(),e}return __extends(e,t),e.prototype.getRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,RES.getRes("how_to_play")];case 1:return t.sheet=e.sent(),this.initView(),[2]}})})},e.prototype.initView=function(){var t=new TSBitmap("bg",this.sheet,!0);t.x=85.3,t.y=98.9,this.addChild(t);var e=new TSBitmap("title",this.sheet,!0);e.x=320,e.y=231.4,this.addChild(e),this.closeBtn=new TSBitmap("closebtn",this.sheet,!0),this.closeBtn.x=513.55,this.closeBtn.y=206.35,this.addChild(this.closeBtn),this.okBtn=new TSBitmap("okbtn",this.sheet,!0),this.okBtn.x=209.9,this.okBtn.y=753.4,this.addChild(this.okBtn),this.retryBtn=new TSBitmap("retryBtn",this.sheet,!0),this.retryBtn.x=427.05,this.retryBtn.y=753.4,this.addChild(this.retryBtn),this.itemctrl=new TSBitmap("itemctrl",this.sheet,!0),this.itemctrl.x=1.85,this.itemctrl.y=804.45,this.addChild(this.itemctrl),this.boy=new TSBitmap("boy1",this.sheet,!0),this.boy.x=134,this.boy.y=391,this.addChild(this.boy)},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(HowToPlayPop.prototype,"HowToPlayPop",["PopBase"]);var ItemGetPop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.setIcon=function(t){SoundManager.getInstance().playSound(SoundEnum.ITEMSOUND_MP3),this.item_icon=new egret.Bitmap,this.item_icon.texture=RES.getRes(t),this.item_icon.x=this.bg_view.width/2-this.item_icon.width/2,this.item_icon.y=this.bg_view.height/2-this.item_icon.height/2,this.addChild(this.item_icon)},e.prototype.initView=function(){this.bg_view=new egret.Bitmap,this.bg_view.texture=RES.getRes("itemget_png"),this.addChild(this.bg_view),this.ok_btn=new egret.Bitmap,this.ok_btn.texture=RES.getRes("okbtn_png"),this.ok_btn.x=this.bg_view.width/2-this.ok_btn.width/2,this.ok_btn.y=this.bg_view.width/2-this.ok_btn.height/2+180,this.ok_btn.touchEnabled=!0,this.addChild(this.ok_btn),this.x=Util.curWidth()/2-this.bg_view.width/2,this.y=Util.curHeight()/2-this.bg_view.height/2,!GuideController.getInstance().showGuide,this.ok_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePop,this)},e.prototype.closePop=function(){SoundManager.getInstance().playSound(SoundEnum.CLICKSOUND_MP3),UIManager.getInstance().closeItemGetPop()},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(ItemGetPop.prototype,"ItemGetPop",["PopBase"]);var JumpStagePop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.jumpPop=new egret.Sprite,this.addChild(this.jumpPop);var t=new egret.Bitmap;t.texture=RES.getRes("board_png"),this.jumpPop.addChild(t);var e=new egret.TextField;e.text="需完成上一关卡才能解锁哟，",this.jumpPop.addChild(e);var i=new egret.TextField;i.text="或者求助好友帮忙解锁？",this.jumpPop.addChild(i),this.ok_btn=new egret.Bitmap,this.ok_btn.texture=RES.getRes("okbtn_png"),this.ok_btn.x=t.width/2-this.ok_btn.width/2,this.ok_btn.y=t.height/2-this.ok_btn.height/2+120,this.ok_btn.touchEnabled=!0,this.jumpPop.addChild(this.ok_btn)},e.prototype.onSharetouched=function(){platform.share("一起来回避生活中的尴尬事吧","https://cdn.joypac.cn/kaihi_h5_res/share.jpg")},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(JumpStagePop.prototype,"JumpStagePop",["PopBase"]);var MenuPop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0,this.bg_view=new TSBitmap("menuFrame_png",null),this.addChild(this.bg_view),this.retry=new TSBitmap("retryBtn_cn_png",null),this.retry.x=this.bg_view.width/2-this.retry.width/2,this.retry.touchEnabled=!0,this.retry.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRetryTouched,this),this.addChild(this.retry),this.other=new TSBitmap("otherStageBtn_cn_png",null),this.other.x=this.bg_view.width/2-this.other.width/2,this.other.touchEnabled=!0,this.other.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onOtherTouched,this),this.addChild(this.other),this.other.y=this.bg_view.height/2-this.other.height/2-76.3,this.retry.y=this.bg_view.height/2-this.retry.height/2+50,this.share=new TSBitmap("share",null),this.share.x=this.bg_view.width/2-this.share.width/2,this.share.y=this.bg_view.height/2-this.share.height/2+179.5,this.share.touchEnabled=!0,this.share.visible=platform.hasShareSDK(),this.share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareTouched,this),this.addChild(this.share),this.close=new TSBitmap("cancel_png",null),this.close.x=this.bg_view.width/2-this.close.width/2+203,this.close.y=this.bg_view.height/2-this.close.height/2-160.9,this.close.touchEnabled=!0,this.close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePop,this),this.addChild(this.close),this.x=Util.curWidth()/2-this.bg_view.width/2,this.y=Util.curHeight()/2-this.bg_view.height/2,this.darkSprite.x=-(Util.curWidth()/2-this.bg_view.width/2),this.darkSprite.y=-(Util.curHeight()/2-this.bg_view.height/2)},e.prototype.onShareTouched=function(){platform.share("一起来回避生活中的尴尬事吧","https://cdn.joypac.cn/kaihi_h5_res/share.jpg")},e.prototype.onOtherTouched=function(){this.destroy(),platform.stopRecord(),AdManager.getInstance().showBanner(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().currentScene.onReset(),UIManager.getInstance().closeMenuPop(),UIManager.getInstance().toTitleScene()},e.prototype.onHelpTouched=function(){this.destroy(),UIManager.getInstance().openHintPop(StageController.getInstance().getCurrentSelected())},e.prototype.onRetryTouched=function(){this.destroy(),platform.stopRecord(),AdManager.getInstance().showInterstitial(),UIManager.getInstance().currentScene.onReset(),UIManager.getInstance().closeMenuPop(),UIManager.getInstance().toGameScene()},e.prototype.closePop=function(){this.destroy(),UIManager.getInstance().closeMenuPop()},e.prototype.destroy=function(){},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(MenuPop.prototype,"MenuPop",["PopBase"]);var NoVedioPop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.3),this.darkSprite.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=Util.curWidth(),this.darkSprite.height=Util.curHeight(),this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!0,this.noVedioPop=new egret.Sprite;var t=new egret.Bitmap;t.texture=RES.getRes("board_png"),this.noVedioPop.addChild(t);var e=new egret.TextField;e.x=40,e.y=30,e.size=30,e.width=t.width-80,e.textColor=0,e.text="视频还在赶来的路上，",this.noVedioPop.addChild(e);var i=new egret.TextField;i.x=40,i.y=100,i.size=25,i.width=t.width-80,i.textColor=2236962,i.text="请稍后再试",i.text="可以等待几十秒后再来看看哦~",this.noVedioPop.addChild(i),this.ok_btn=new egret.Bitmap,this.ok_btn.texture=RES.getRes("okbtn_png"),this.ok_btn.x=t.width/2-this.ok_btn.width/2,this.ok_btn.y=t.height/2-this.ok_btn.height/2+120,this.ok_btn.touchEnabled=!0,this.noVedioPop.addChild(this.ok_btn),this.addChild(this.noVedioPop),this.touchEnabled=!0,this.ok_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this),this.x=Util.curWidth()/2-this.noVedioPop.width/2,this.y=Util.curHeight()/2-this.noVedioPop.height/2,this.darkSprite.x=-(Util.curWidth()/2-this.noVedioPop.width/2),this.darkSprite.y=-(Util.curHeight()/2-this.noVedioPop.height/2)},e.prototype.onTouch=function(t){UIManager.getInstance().closeNoVedioPop()},e.prototype.destroy=function(){},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(NoVedioPop.prototype,"NoVedioPop",["PopBase"]);var StageTitlePop=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.play_loop=function(){},e}(egret.Sprite);__reflect(StageTitlePop.prototype,"StageTitlePop",["PopBase"]);var DataScene=function(t){function e(e){var i=t.call(this)||this;return i.PAGE_NUM=12,i.CARD_PER_PAGE=12,i.initData(),i.initView(e),i}return __extends(e,t),e.prototype.initData=function(){this.config=Config.getInstance().card_tip},e.prototype.initView=function(t){this.egretStage=t,this.sheet=RES.getRes("data_scene");var e=RES.getRes("head_ui");this.currentPage=1;var i=new TSBitmap("bg",this.sheet);i.x=-100,i.height=this.egretStage.height,i.y=-Util.y_fix(),this.addChild(i),this.data_head=new DataHead(e),this.cardView=new egret.Sprite,this.addChild(this.cardView);var n,r;this.pages=[null],this.cards=[];for(var s=1;s<=this.PAGE_NUM;s++){n=new egret.Sprite,n.x=320,n.y=500;for(var a=1;a<=this.CARD_PER_PAGE&&12*(s-1)+a!==this.config.length;a++)r=new CardView(this.sheet,12*(s-1)+a),r.x=(a-1)%4*150-224.95,r.y=220*Math.floor((a-1)/4)-223.6,n.addChild(r),r.touchEnabled=!0,r.touchChildren=!1,this.cards.push(r),r.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cardTouched,this);this.pages.push(n)}this.cardView.addChild(this.pages[this.currentPage]);var o="wxgame"===platform.name?50:0,h=new TSBitmap("page",e);h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,h.x=320,h.y=951.15-o,this.addChild(h),this.pageText=new egret.TextField,this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage),this.pageText.anchorOffsetX=this.pageText.width/2,this.pageText.anchorOffsetY=this.pageText.height/2,this.pageText.x=320,this.pageText.y=951.15-o,this.pageText.textColor=0,this.addChild(this.pageText),this.left=new TSBitmap("left",e),this.left.anchorOffsetX=this.left.width/2,this.left.anchorOffsetY=this.left.height/2,this.left.x=66.4,this.left.y=950.5,this.left.touchEnabled=!0,this.left.visible=!1,this.left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftPage,this),this.addChild(this.left),this.right=new TSBitmap("left",e),this.right.scaleX=-1,this.right.anchorOffsetX=this.right.width/2,this.right.anchorOffsetY=this.right.height/2,this.right.x=572.6,this.right.y=950.5,this.right.touchEnabled=!0,this.right.visible="wxgame"===platform.name?!1:!0,this.right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightPage,this),this.addChild(this.right),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSwipeBegin,this)},e.prototype.onAdd=function(t){UIManager.getInstance().getUILayer().addChild(this.data_head),this.updateView()},e.prototype.updateView=function(){for(var t=0;t<this.cards.length;t++)this.cards[t].updateView()},e.prototype.cardTouched=function(t){var e=t.target;3===e.cardStatus?this.showDetail(e.cardNumber):platform.hasVedioSDK()&&this.showHint(e.cardDetail,e.cardStatus)},e.prototype.showHint=function(t,e){UIManager.getInstance().openCollectionHintPop(t,e)},e.prototype.showDetail=function(t){var e=DataController.getInstance().getCollectionedCards(t);UIManager.getInstance().openCardPop(e.cards,e.index)},e.prototype.updatePageText=function(){this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage)},e.prototype.onSwipeBegin=function(t){this.touchX=t.stageX,this.addEventListener(egret.TouchEvent.TOUCH_END,this.onSwipeEnd,this)},e.prototype.onSwipeEnd=function(t){this.touchX-t.stageX>50?this.rightPage():this.touchX-t.stageX<-50&&this.leftPage()},e.prototype.rightPage=function(){this.currentPage!==this.PAGE_NUM&&(1===this.currentPage&&(this.left.visible="wxgame"===platform.name?!1:!0),this.showRightPageEffect(),this.currentPage+=1,this.updatePageText(),this.currentPage===this.PAGE_NUM&&(this.right.visible=!1))},e.prototype.leftPage=function(){1!==this.currentPage&&(this.currentPage===this.PAGE_NUM&&(this.right.visible="wxgame"===platform.name?!1:!0),this.showLeftPageEffect(),this.currentPage-=1,this.updatePageText(),1===this.currentPage&&(this.left.visible=!1))},e.prototype.showLeftPageEffect=function(){this.currentPage>this.PAGE_NUM||this.currentPage<0||(this.cardView.contains(this.pages[this.currentPage])&&this.cardView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:1280},100).call(function(){}));var t=this.currentPage-1;t>this.PAGE_NUM||0>t||(this.cardView.contains(this.pages[t])||this.cardView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.showRightPageEffect=function(){this.currentPage>this.PAGE_NUM||this.currentPage<0||(this.cardView.contains(this.pages[this.currentPage])&&this.cardView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:-640},100).call(function(){}));var t=this.currentPage+1;t>this.PAGE_NUM||0>t||(this.cardView.contains(this.pages[t])||this.cardView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.start_loop=function(){},e.prototype.stop_loop=function(){},e}(egret.DisplayObjectContainer);__reflect(DataScene.prototype,"DataScene",["IFSceen"]);var GameScene=function(t){function e(e){var i=t.call(this)||this;return i.currentStage=null,i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){this.egretStage=t,this.game_head=new GameHead,this.itemCtrl=ItemCtrlView.getInstance(t),this.itemCtrl.scene=this,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.start_loop,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.stop_loop,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this)},e.prototype.onAdd=function(t){UIManager.getInstance().getUILayer().addChild(this.game_head),UIManager.getInstance().getUILayer().addChild(this.itemCtrl),this.game_head.updateView()},e.prototype.setGameStage=function(){var t=StageController.getInstance().getCurrentSelected(),e=new StageParse(1,t);this.currentStage=e,StageController.getInstance().parse=e,Util.scaleMode()===egret.StageScaleMode.FIXED_HEIGHT&&(e.scaleX=Util.curWidth()/Util.displayWidth(),e.x=(Util.displayWidth()-Util.curWidth())/2,e.y=(Util.displayHeight()-Util.curHeight())/2),this.addChild(e),StageController.getInstance().parse=e,this.game_head.updateView(),this.game_head.touchEnabled=!0,this.game_head.touchChildren=!0,this.itemCtrl.touchEnabled=!0,this.itemCtrl.touchChildren=!0,AdManager.getInstance().hideBanner()},e.prototype.onGameOver=function(){ItemController.getInstance().resetList(),this.removeChild(this.currentStage),this.currentStage._remove(),this.currentStage=null,this.game_head.touchEnabled=!1,this.itemCtrl.touchEnabled=!1},e.prototype.onClear=function(){ItemController.getInstance().resetList(),this.removeChild(this.currentStage),this.currentStage._remove(),this.currentStage=null,this.game_head.touchEnabled=!1,this.itemCtrl.touchEnabled=!1,this.itemCtrl.updateItems()},e.prototype.onReset=function(){ItemController.getInstance().resetList(),this.removeChild(this.currentStage),this.currentStage._remove(),this.currentStage=null,this.game_head.touchEnabled=!1,this.itemCtrl.touchEnabled=!1,this.itemCtrl.updateItems()},e.prototype.start_loop=function(t){this.timer=new egret.Timer(1e3/30,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.play_loop,this),this.timer.start()},e.prototype.stop_loop=function(t){this.egretStage.hasEventListener(egret.Event.ENTER_FRAME)===!0&&(this.timer.removeEventListener(egret.TimerEvent.TIMER,this.play_loop,this),this.timer.stop())},e.prototype.play_loop=function(t){UIManager.getInstance().isPopUp?UIManager.getInstance().getCurrentPop().play_loop():null!==this.currentStage&&this.currentStage.play_loop()},e.prototype.getCurrentStage=function(){return this.currentStage},e}(egret.DisplayObjectContainer);__reflect(GameScene.prototype,"GameScene",["IFSceen"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,r;return __generator(this,function(s){return t=new egret.Bitmap,t.texture=RES.getRes("loading_bg_png"),this.addChild(t),this.stageText=new egret.TextField,this.stageText.size=120,this.stageText.textColor=16777215,this.stageText.visible=!1,this.addChild(this.stageText),e=new egret.Bitmap,e.texture=RES.getRes("c05_boss1_png"),e.x=50,e.y=450,this.addChild(e),i=new egret.Bitmap,i.texture=RES.getRes("c01_buka1_png"),i.x=Util.curWidth()-i.width-50,i.y=470,this.addChild(i),n=new egret.Bitmap,n.texture=RES.getRes("logo_cn_png"),n.width=344,n.height=110,n.x=Util.curWidth()-n.width-50,n.y=Util.curHeight()-n.height-250,this.addChild(n),r=new egret.Timer(5e3,1),r.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.networkNotConnect,this),[2]})})},e.prototype.networkNotConnect=function(){var t=new egret.TextField;t.x=100,t.y=614,t.textColor=0,t.text="您当前网络状况很差，请联网再试",this.addChild(t)},e.prototype.showStage=function(t){this.stageText.visible=t},e.prototype.onShow=function(){this.stageText.text="关卡"+StageController.getInstance().getCurrentSelected(),this.stageText.x=Util.curWidth()/2-this.stageText.width/2,this.stageText.y=140},e.prototype.onHide=function(){},e.prototype.onProgress=function(t,e){},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var RankScene=function(t){function e(e){var i=t.call(this)||this;return i.page_num=1,i.RANK_ITEM_PER_PAGE=5,i.sortedData=[],i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){this.egretStage=t,this.sheet=RES.getRes("data_scene");var e=RES.getRes("head_ui");this.currentPage=1;var i=new TSBitmap("bg",this.sheet);i.x=-100,i.height=this.egretStage.height,i.y=-Util.y_fix(),this.addChild(i),this.rank_head=new RankHead(e),this.rankView=new egret.Sprite,this.addChild(this.rankView);var n="wxgame"===platform.name?50:0;this.pagebg=new TSBitmap("page",e),this.pagebg.anchorOffsetX=this.pagebg.width/2,this.pagebg.anchorOffsetY=this.pagebg.height/2,this.pagebg.x=320,this.pagebg.y=951.15-n,this.addChild(this.pagebg),this.pageText=new egret.TextField,this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage),this.pageText.anchorOffsetX=this.pageText.width/2,this.pageText.anchorOffsetY=this.pageText.height/2,this.pageText.x=320,this.pageText.y=951.15-n,this.pageText.textColor=0,this.addChild(this.pageText),this.left=new TSBitmap("left",e),this.left.anchorOffsetX=this.left.width/2,this.left.anchorOffsetY=this.left.height/2,this.left.x=66.4,this.left.y=950.5,this.left.touchEnabled=!0,this.left.visible=!1,this.left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftPage,this),this.addChild(this.left),this.right=new TSBitmap("left",e),this.right.scaleX=-1,this.right.anchorOffsetX=this.right.width/2,this.right.anchorOffsetY=this.right.height/2,this.right.x=572.6,this.right.y=950.5,this.right.touchEnabled=!0,this.right.visible=!1,this.right.visible="wxgame"===platform.name?!1:!0,this.right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightPage,this),this.addChild(this.right),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSwipeBegin,this),this.updateView(),GameAnalyticsController.getInstance().rankEnterAnalytics()},e.prototype.onAdd=function(t){UIManager.getInstance().getUILayer().addChild(this.rank_head)},e.prototype.backTouched=function(t){this.contains(this.bitmap)&&this.removeChild(this.bitmap),this.contains(this.back_btn)&&this.removeChild(this.back_btn),platform.rankView(!1)},e.prototype.updateView=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i;return __generator(this,function(n){switch(n.label){case 0:return"wxgame"!==platform.name?[3,1]:(this.currentPage<1&&(this.currentPage=1),this.left.visible="wxgame"===platform.name?!1:!0,this.right.visible="wxgame"===platform.name?!1:!0,this.pagebg.visible=!1,this.pageText.visible=!1,this.bitmap=platform.openDataContext.createDisplayObject(null,this.egretStage.stageWidth,this.egretStage.stageHeight),this.bitmap.touchEnabled=!0,this.bitmap.y=150,this.rankView.addChild(this.bitmap),console.log(this.currentPage),platform.openDataContext.postMessage({isDisplay:!0,year:(new Date).getFullYear(),command:"open"}),[3,3]);case 1:return t=this,[4,platform.getRank()];case 2:for(t.ranks=n.sent(),this.page_num=Math.ceil(this.ranks.length/this.RANK_ITEM_PER_PAGE),this.page_num>0&&(this.page_num>1&&(this.right.visible="wxgame"===platform.name?!1:!0),this.currentPage=1),this.rankView.removeChildren(),e=void 0,i=0;i<this.RANK_ITEM_PER_PAGE&&5*(this.currentPage-1)+i!==this.ranks.length;i++)e=new RankItem,e.y=150*i+150,e.setPlayerData(5*(this.currentPage-1)+i+1,this.ranks[5*(this.currentPage-1)+i]),this.rankView.addChild(e);n.label=3;case 3:return[2]}})})},e.prototype.updatePageText=function(){this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage)},e.prototype.onSwipeBegin=function(t){this.touchX=t.stageX,this.addEventListener(egret.TouchEvent.TOUCH_END,this.onSwipeEnd,this)},e.prototype.onSwipeEnd=function(t){this.touchX-t.stageX>50?this.rightPage():this.touchX-t.stageX<-50&&this.leftPage()},e.prototype.rightPage=function(){return"wxgame"===platform.name?void platform.openDataContext.postMessage({isDisplay:!0,year:(new Date).getFullYear(),command:"nextPage"}):void(this.currentPage!==this.page_num&&(1===this.currentPage&&(this.left.visible="wxgame"===platform.name?!1:!0),this.currentPage+=1,this.updateView(),this.updatePageText(),this.currentPage===this.page_num&&(this.right.visible=!1)))},e.prototype.leftPage=function(){return"wxgame"===platform.name?void platform.openDataContext.postMessage({isDisplay:!0,year:(new Date).getFullYear(),command:"prePage"}):void(1!==this.currentPage&&(this.currentPage===this.page_num&&(this.right.visible="wxgame"===platform.name?!1:!0),this.currentPage-=1,this.updateView(),this.updatePageText(),1===this.currentPage&&(this.left.visible=!1)))},e.prototype.showLeftPageEffect=function(){this.currentPage>this.page_num||this.currentPage<0||(this.rankView.contains(this.pages[this.currentPage])&&this.rankView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:1280},100).call(function(){}));var t=this.currentPage-1;t>this.page_num||0>t||(this.rankView.contains(this.pages[t])||this.rankView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.showRightPageEffect=function(){this.currentPage>this.page_num||this.currentPage<0||(this.rankView.contains(this.pages[this.currentPage])&&this.rankView.removeChild(this.pages[this.currentPage]),egret.Tween.get(this.pages[this.currentPage],{loop:!1}).to({x:-640},100).call(function(){}));var t=this.currentPage+1;t>this.page_num||0>t||(this.rankView.contains(this.pages[t])||this.rankView.addChild(this.pages[t]),egret.Tween.get(this.pages[t],{loop:!1}).to({x:320},100).call(function(){}))},e.prototype.start_loop=function(){},e.prototype.stop_loop=function(){},e}(egret.DisplayObjectContainer);__reflect(RankScene.prototype,"RankScene",["IFSceen"]);var TitleScene=function(t){function e(e){var i=t.call(this)||this;return i.GAME_STARTED=!1,i.egretStage=e,i.initView(),i}return __extends(e,t),e.prototype.loadRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,RES.loadGroup("pops")];case 1:return t.sent(),UIManager.getInstance().setSheet(),[2]}})})},e.prototype.initView=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,r,s,a,o,h,c,l;return __generator(this,function(d){return this.init_sheet=RES.getRes("title_init"),this.screen_splash=new egret.Shape,this.screen_splash.graphics.beginFill(16777215),this.screen_splash.graphics.drawRect(0,0,Util.curWidth(),Util.curHeight()),this.screen_splash.graphics.endFill(),this.screen_splash.touchEnabled=!1,this.addChild(this.screen_splash),this.selectedStage=StageController.getInstance().getCurrentSelected(),this.currentPage=Math.floor((this.selectedStage-1)/6)+1,this.selectSprite1=new egret.Sprite,this.selectSprite2=new egret.Sprite,t=new TSBitmap("select1",this.init_sheet),e=new TSBitmap("select1",this.init_sheet),t.x=e.x=Util.displayWidth()/2-t.width/2,t.y=e.y=0,this.selectSprite1.addChild(t),this.selectSprite2.addChild(e),i=new TSBitmap("select2",this.init_sheet),n=new TSBitmap("select2",this.init_sheet),i.x=n.x=Util.displayWidth()/2-t.width/2,i.y=n.y=780,this.selectSprite1.addChild(i),this.selectSprite2.addChild(n),r=new TSBitmap("select3",this.init_sheet),s=new TSBitmap("select3",this.init_sheet),r.x=s.x=Util.displayWidth()/2-t.width/2,r.y=s.y=1560,this.selectSprite1.addChild(r),this.selectSprite2.addChild(s),a=new TSBitmap("select4",this.init_sheet),o=new TSBitmap("select4",this.init_sheet),a.x=o.x=Util.displayWidth()/2-t.width/2,a.y=o.y=2340,this.selectSprite1.addChild(a),this.selectSprite2.addChild(o),h=new TSBitmap("select5",this.init_sheet),c=new TSBitmap("select5",this.init_sheet),h.x=c.x=Util.displayWidth()/2-t.width/2,h.y=c.y=3120,this.selectSprite1.addChild(h),this.selectSprite2.addChild(c),this.selectSprite2.y=this.selectSprite1.height,this.addChild(this.selectSprite1),this.addChild(this.selectSprite2),l=new egret.Bitmap(RES.getRes("loading_bg_png")),l.x=-100,l.height=this.egretStage.height,l.y=-Util.y_fix(),this.addChild(l),l.alpha=.8,this.title=new TSBitmap("title",this.init_sheet),this.title.anchorOffsetX=this.title.width/2,this.title.anchorOffsetY=this.title.height/2,this.title.x=320,this.title.y=493.1,this.addChild(this.title),this.start_btn=new TSBitmap("start",this.init_sheet),this.start_btn.touchEnabled=!0,this.start_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),this.breathEffect=TSEffect.breathEffect(this.start_btn,-1),this.start_btn.x=320,this.start_btn.y=777.6,this.addChild(this.start_btn),this.version=new egret.TextField,this.version.text="v1.0.3",this.version.textColor=0,this.version.x=Util.curWidth()-this.version.width,this.version.y=Util.curHeight()-this.version.height,this.addChild(this.version),Util.gameStage().addEventListener(egret.MovieClipEvent.ENTER_FRAME,this.play_loop,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),[2]})})},e.prototype.startGame=function(t){return void 0===t&&(t=null),__awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(r){switch(r.label){case 0:return UIManager.getInstance().toGameScene(),[2];case 1:for(r.sent(),null!==t&&SoundManager.getInstance().playSound(SoundEnum.SELECTSOUND_MP3),this.head_sheet=RES.getRes("head_ui"),this.title_head=new TitleHead(this.head_sheet),this.GAME_STARTED===!1&&(UIManager.getInstance().getUILayer().addChild(this.title_head),this.title_head.updateView()),this.GAME_STARTED=!0,this.version.visible=!1,AdManager.getInstance().showBanner(),this.breathEffect.destroy(),this.title.visible=!1,this.start_btn.visible=!1,this.removeChild(this.title),this.removeChild(this.start_btn),this.title_head.visible=!0,e="wxgame"===platform.name?50:0,e="qqgame"===platform.name?50:e,this.selectView=new egret.Sprite,i=1;5>=i;i++)this["selectPanel"+i]=new SelectPanel(i),this.currentPage>i?this["selectPanel"+i].x=-640:this.currentPage===i?this["selectPanel"+i].x=320:this["selectPanel"+i].x=1280,this["selectPanel"+i].y=520;
return this.selectView.addChild(this["selectPanel"+this.currentPage]),this.selectView.y=-e,this.addChild(this.selectView),n=new TSBitmap("page",this.head_sheet),n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=320,n.y=951.15-e,this.addChild(n),this.pageText=new egret.TextField,this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage),this.pageText.anchorOffsetX=this.pageText.width/2,this.pageText.anchorOffsetY=this.pageText.height/2,this.pageText.x=320,this.pageText.y=951.15-e,this.pageText.textColor=0,this.addChild(this.pageText),this.left=new TSBitmap("left",this.head_sheet),this.left.anchorOffsetX=this.left.width/2,this.left.anchorOffsetY=this.left.height/2,this.left.x=66.4,this.left.y=950.5-e,this.left.touchEnabled=!0,this.left.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftPage,this),this.left.visible="wxgame"===platform.name?!1:!0,this.addChild(this.left),this.right=new TSBitmap("left",this.head_sheet),this.right.scaleX=-1,this.right.anchorOffsetX=this.right.width/2,this.right.anchorOffsetY=this.right.height/2,this.right.x=572.6,this.right.y=950.5-e,this.right.touchEnabled=!0,this.right.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightPage,this),this.right.visible="wxgame"===platform.name?!1:!0,this.addChild(this.right),1===this.currentPage?this.left.visible=!1:5===this.currentPage&&(this.right.visible=!1),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onSwipeBegin,this),this.setLastPlaySelected(),StageController.getInstance().getDispather().addEventListener(StageEvent.STAGE_SELECED,this.selectStage,this),[2]}})})},e.prototype.onAdd=function(t){this.GAME_STARTED&&(UIManager.getInstance().getUILayer().addChild(this.title_head),this.title_head.updateView(),this.updatePageView())},e.prototype.setLastPlaySelected=function(){this.selectedStageView=this["selectPanel"+this.currentPage].getStageList()[(this.selectedStage-1)%6],this.selectedStageView.setSelected(!0)},e.prototype.onSwipeBegin=function(t){this.touchX=t.stageX,this.addEventListener(egret.TouchEvent.TOUCH_END,this.onSwipeEnd,this)},e.prototype.onSwipeEnd=function(t){this.touchX-t.stageX>50?this.rightPage():this.touchX-t.stageX<-50&&this.leftPage()},e.prototype.selectStage=function(t){void 0!==this.selectedStageView&&this.selectedStageView.setSelected(!1),this.selectedStage=t.getStage(),this.selectedStageView=this["selectPanel"+this.currentPage].getStageList()[(this.selectedStage-1)%6],this.selectedStageView.setSelected(!0)},e.prototype.updatePageText=function(){this.pageText.text=I18nManager.getInstance().getLanguageByName(LanguageEnum.PAGE_SELECT).replace("$d",this.currentPage)},e.prototype.updatePageView=function(){this["selectPanel"+this.currentPage].updateView()},e.prototype.rightPage=function(){5!==this.currentPage&&(1===this.currentPage&&(this.left.visible="wxgame"===platform.name?!1:!0),this.showRightPageEffect(),StageController.getInstance().clearNewOpenList(this.currentPage),this.currentPage+=1,this.updatePageText(),5===this.currentPage&&(this.right.visible=!1),this.updatePageView())},e.prototype.leftPage=function(){1!==this.currentPage&&(5===this.currentPage&&(this.right.visible="wxgame"===platform.name?!1:!0),this.showLeftPageEffect(),StageController.getInstance().clearNewOpenList(this.currentPage),this.currentPage-=1,this.updatePageText(),1===this.currentPage&&(this.left.visible=!1),this.updatePageView())},e.prototype.showLeftPageEffect=function(){var t=this;this.currentPage>5||this.currentPage<0||(this.selectView.contains(this["selectPanel"+this.currentPage])&&this.selectView.removeChild(this["selectPanel"+this.currentPage]),egret.Tween.get(this["selectPanel"+this.currentPage],{loop:!1}).to({x:1280},100));var e=this.currentPage-1;e>5||0>e||(this.selectView.contains(this["selectPanel"+e])||this.selectView.addChild(this["selectPanel"+e]),egret.Tween.get(this["selectPanel"+e],{loop:!1}).to({x:320},100).call(function(){for(var e,i,n=StageController.getInstance().getNewClearList().length-1;n>=0;n--)i=StageController.getInstance().getNewClearList()[n],i/6+1===t.currentPage&&(e=t["selectPanel"+t.currentPage].getStageList()[(i-1)%6],e.updateStatus(),StageController.getInstance().getNewClearList().splice(i,1))}))},e.prototype.showRightPageEffect=function(){var t=this;this.currentPage>5||this.currentPage<0||(this.selectView.contains(this["selectPanel"+this.currentPage])&&this.selectView.removeChild(this["selectPanel"+this.currentPage]),egret.Tween.get(this["selectPanel"+this.currentPage],{loop:!1}).to({x:-640},100));var e=this.currentPage+1;e>5||0>e||(this.selectView.contains(this["selectPanel"+e])||this.selectView.addChild(this["selectPanel"+e]),egret.Tween.get(this["selectPanel"+e],{loop:!1}).to({x:320},100).call(function(){for(var e,i,n=StageController.getInstance().getNewClearList().length-1;n>=0;n--)i=StageController.getInstance().getNewClearList()[n],i/6+1===t.currentPage&&(e=t["selectPanel"+t.currentPage].getStageList()[(i-1)%6],e.updateStatus(),StageController.getInstance().getNewClearList().splice(i,1))}))},e.prototype.play_loop=function(t){this.GAME_STARTED?(this.selectSprite1.y-=1,this.selectSprite2.y-=1,this.selectSprite1.y===-this.selectSprite1.height&&(this.selectSprite1.y=this.selectSprite1.height),this.selectSprite2.y===-this.selectSprite1.height&&(this.selectSprite2.y=this.selectSprite1.height)):(this.selectSprite1.y-=5,this.selectSprite2.y-=5,this.selectSprite1.y===-this.selectSprite1.height&&(this.selectSprite1.y=this.selectSprite1.height),this.selectSprite2.y===-this.selectSprite1.height&&(this.selectSprite2.y=this.selectSprite1.height))},e}(egret.DisplayObjectContainer);__reflect(TitleScene.prototype,"TitleScene",["IFSceen"]);var CardView=function(t){function e(e,i){var n=t.call(this)||this;return n.detail=Config.getInstance().card_tip[i],n.initView(e),n}return __extends(e,t),e.prototype.initView=function(t){this.status=SaveData.getInstance().getCardStatus(this.detail.No),this.noText=new egret.TextField,this.noText.text="No. "+this.detail.No,this.noText.x=-65.7,this.noText.y=-91,this.noText.width=118.7,this.noText.height=26,this.noText.textColor=0,this.noText.size=22,this.addChild(this.noText),this.card_bf=new TSBitmap("card_bf"+this.detail.star,t,!0),this.card_bg=new TSBitmap("card_bg"+this.detail.star,t,!0),parseInt(this.status)/2>=1?(this.card=new TSBitmap(this.detail.No+"_"+this.detail.stage+"_"+this.detail.result,RES.getRes("card_sheet"),!0),this.card.touchEnabled=!0,this.addChild(this.card),this.addChild(this.card_bf)):this.addChild(this.card_bg),this.stars=new egret.Sprite;for(var e,i=0;i<this.detail.star;i++)e=new TSBitmap("star",t),e.x=32.15-e.width*i,e.y=66.9,this.stars.addChild(e);this.addChild(this.stars)},e.prototype.updateView=function(){this.status=SaveData.getInstance().getCardStatus(this.detail.No),parseInt(this.status)/2>=1&&(this.contains(this.card_bg)&&this.removeChild(this.card_bg),this.card=new TSBitmap(this.detail.No+"_"+this.detail.stage+"_"+this.detail.result,RES.getRes("card_sheet"),!0),this.card.touchEnabled=!1,this.addChild(this.card),this.addChild(this.card_bf))},Object.defineProperty(e.prototype,"cardDetail",{get:function(){return this.detail},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cardNumber",{get:function(){return this.detail.No},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cardStatus",{get:function(){return this.status},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(CardView.prototype,"CardView");var DataHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.title=new TSBitmap("title",RES.getRes("data_scene")),this.title.x=143.5,this.title.y=15.5,this.addChild(this.title),this.back_btn=new TSBitmap("back_btn",t,!0),this.back_btn.x=80,this.back_btn.y=40,this.back_btn.touchEnabled=!0,this.addChild(this.back_btn),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backTouched,this),UIManager.getInstance().getUILayer().addChild(this)},e.prototype.backTouched=function(){UIManager.getInstance().toTitleScene()},e}(egret.Sprite);__reflect(DataHead.prototype,"DataHead");var GameHead=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=new TSBitmap("head_png");t.x=0,t.y=0,this.addChild(t),this.stageBg=new egret.Bitmap,this.stageBg.texture=RES.getRes("stageNo_png"),this.stageBg.y=40,this.addChild(this.stageBg),this.stageId=new egret.TextField,this.stageId.size=35,this.stageId.textColor=16777215,this.addChild(this.stageId),this.menu_button=new TSBitmap("menu_png"),this.menu_button.x=580-platform.offsetHead(),this.menu_button.y=40,this.menu_button.touchEnabled=!0,this.addChild(this.menu_button),this.menu_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showMenu,this),this.hint_button=new TSBitmap("hintBtn_cn_png"),this.hint_button.x=450-platform.offsetHead(),this.hint_button.y=40,this.hint_button.touchEnabled=!0,this.addChild(this.hint_button),this.hint_button.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showHint,this),UIManager.getInstance().getUILayer().addChild(this),this.updateView()},e.prototype.updateView=function(){this.stageId.text="关卡"+StageController.getInstance().getCurrentSelected(),this.stageId.x=(this.stageBg.width-this.stageId.width)/2,this.stageId.y=this.stageBg.y+(this.stageBg.height-this.stageId.height)/2},e.prototype.showMenu=function(){UIManager.getInstance().openMenuPop()},e.prototype.showHint=function(){UIManager.getInstance().openHintPop(this.stageId)},e.prototype.showVoice=function(){SettingController.getInstance().SoundPlaying?(this.voice.getChildByName("off").visible=!1,this.voice.getChildByName("on").visible=!0):(this.voice.getChildByName("on").visible=!1,this.voice.getChildByName("off").visible=!0)},e.prototype.changeVoice=function(){SettingController.getInstance().SoundPlaying?SettingController.getInstance().SoundPlaying=!1:SettingController.getInstance().SoundPlaying=!0,this.showVoice()},e}(egret.Sprite);__reflect(GameHead.prototype,"GameHead");var Item=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;i.item_name=e,i.png=new egret.Bitmap;var n=RES.getRes(e);return i.png.texture=n,i}return __extends(e,t),e.prototype.getName=function(){return this.item_name},e}(egret.Bitmap);__reflect(Item.prototype,"Item");var ItemCtrlView=function(t){function e(e){var i=t.call(this)||this;return i.drag=new egret.Bitmap,i.egretStage=e,i.init(),i}return __extends(e,t),e.getInstance=function(t){return void 0===t&&(t=null),null===this.instance?this.instance=new e(t):null!=t&&null===this.instance.egretStage&&(this.instance.egretStage=t),this.instance},e.prototype.init=function(){this.container=new egret.Sprite,this.addChild(this.container),this.addChild(this.drag),this.drag.visible=!1;var t=new TSBitmap("items_png");t.touchEnabled=!0,this.container.addChild(t),this.container.x=0,this.container.y=Util.displayHeight()-this.container.height,UIManager.getInstance().getGameLayer().addChild(this)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.updateItems=function(t){void 0===t&&(t=!0);for(var e=ItemController.getInstance().getItemList(),i=0;5>i;i++)i<e.length?((void 0===this["item"+i]||null===this["item"+i])&&(this["item"+i]=new egret.Bitmap),this["item"+i].texture=RES.getRes(StageController.getInstance().parse.items[e[i]].res),this["item"+i].name=StageController.getInstance().parse.items[e[i]].res,this["item"+i].id=e[i],this["item"+i].width=115,this["item"+i].height=115,this["item"+i].x=127*i+45,this["item"+i].y=18,this["item"+i].visible=!0,this["item"+i].touchEnabled=!0,this["item"+i].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onItemTouchBegin,this),this.container.addChild(this["item"+i])):void 0!==this["item"+i]&&null!==this["item"+i]&&this["item"+i].parent===this.container&&(this.container.removeChild(this["item"+i]),this["item"+i]=null)},e.prototype.onFireOpend=function(){},e.prototype.addItem=function(t){this.container.addChild(t)},e.prototype.useItem=function(t){this["item"+t]=null,this.container.removeChild(this["item"+t])},e.prototype.getItem=function(t){return this["item"+t]},e.prototype.cancelItemCurrentDrag=function(){-1!==this.dragId&&(this.drag.visible=!1,this.dragId=-1)},e.prototype.cancelItem=function(t){var e=ItemController.getInstance().getIndexOf(t);this["item"+e]&&(this["item"+e].visible=!0)},e.prototype.onItemTouchBegin=function(t){t.target.visible=!1,this.drag.texture=RES.getRes(t.target.name),this.drag.width=this.drag.height=100*Util.factor(),this.dragId=t.target.id,this.drag.x=t.stageX-50*Util.factor()-Util.x_fix(),this.drag.y=t.stageY-50*Util.factor()-Util.y_fix(),this.drag.visible=!0,this.egretStage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemTouchMove,this),this.egretStage.addEventListener(egret.TouchEvent.TOUCH_END,this.onItemTouchEnd,this),GuideController.getInstance().showGuide||this.hideDragGuide()},e.prototype.onItemTouchMove=function(t){this.drag.x=t.stageX-50*Util.factor()-Util.x_fix(),this.drag.y=t.stageY-50*Util.factor()-Util.y_fix()},e.prototype.onItemTouchEnd=function(t){this.egretStage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onItemTouchMove,this),this.egretStage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onItemTouchEnd,this),UIManager.getInstance().currentScene.getCurrentStage().useItem(this.dragId,t.stageX,t.stageY)?ItemController.getInstance().useItem(this.dragId):this.cancelItem(this.dragId),this.drag.visible=!1,this.dragId=-1},e.prototype.showDragGuide=function(t,e){if(1===GuideController.getInstance().guideStep){var i=this.localToGlobal(this.container.x+this.item0.x-Util.x_fix(),this.container.y+this.item0.y-Util.y_fix());this.dragHand.x=i.x,this.dragHand.y=i.y,this.dragHand.visible=!0,egret.Tween.get(this.dragHand,{loop:!0}).to({x:t-Util.x_fix(),y:e-Util.y_fix()},2e3)}},e.prototype.hideDragGuide=function(){this.dragHand.visible=!1,egret.Tween.removeTweens(this.dragHand)},e.prototype.finishDragGuide=function(){GuideController.getInstance().nextStep()},Object.defineProperty(e.prototype,"currentDragId",{get:function(){return void 0===this.dragId&&(this.dragId=-1),this.dragId},enumerable:!0,configurable:!0}),e.instance=null,e}(egret.Sprite);__reflect(ItemCtrlView.prototype,"ItemCtrlView");var MtgAdIcon=function(t){function e(e){var i=t.call(this)||this;return i.iconUrl=e,i.initView(),i}return __extends(e,t),e.prototype.initView=function(){var t=new eui.Image;t.source=this.iconUrl,this.addChild(t),t.width=100,t.height=100,this.circleMask=new egret.Shape,this.circleMask.graphics.beginFill(0),this.circleMask.graphics.drawCircle(50,50,50),this.circleMask.graphics.endFill(),this.addChild(this.circleMask),t.mask=this.circleMask,this.skin=new egret.Bitmap,this.skin=RES.getRes("commend_png"),this.skin.x=50,this.skin.y=50,this.skin.anchorOffsetX=this.skin.width/2,this.skin.anchorOffsetY=this.skin.height/2,this.addChild(this.skin)},e}(egret.Sprite);__reflect(MtgAdIcon.prototype,"MtgAdIcon");var RankHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.title=new TSBitmap("rank_title_png",RES.getRes("title_scene")),this.title.x=143.5,this.title.y=15.5,this.addChild(this.title),this.back_btn=new TSBitmap("back_btn",t,!0),this.back_btn.x=80,this.back_btn.y=40,this.back_btn.touchEnabled=!0,this.addChild(this.back_btn),this.back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backTouched,this),UIManager.getInstance().getUILayer().addChild(this)},e.prototype.backTouched=function(){"wxgame"===platform.name&&platform.openDataContext.postMessage({isDisplay:!1,year:(new Date).getFullYear(),command:"close"}),UIManager.getInstance().toTitleScene()},e}(egret.Sprite);__reflect(RankHead.prototype,"RankHead");var RankItem=function(t){function e(){var e=t.call(this)||this;return e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this.rank_index_text=new egret.TextField,this.rank_index_text.x=45,this.rank_index_text.y=30,this.rank_index_text.text="",this.rank_index_text.fontFamily="KaiTi",this.rank_index_text.textColor=3551278,this.addChild(this.rank_index_text),this.player_head=new egret.Bitmap,this.player_head.y=-20,this.addChild(this.player_head),this.head_crown=new egret.Bitmap,this.head_crown.y=-10,this.player_name_text=new egret.TextField,this.player_name_text.x=260,this.player_name_text.y=30,this.player_name_text.text="",this.player_name_text.textColor=3551278,this.addChild(this.player_name_text),this.total_card_text=new egret.TextField,this.total_card_text.x=410,this.total_card_text.y=30,this.total_card_text.text="0",this.total_card_text.textColor=16284771,this.addChild(this.total_card_text)},e.prototype.updateView=function(){this.rank_index_text.text="No."+this.rank_index,this.player_head.x=55+this.rank_index_text.width,this.player_name_text.text=this.player_name.length>4?this.player_name.slice(0,4)+"...":this.player_name,this.total_card_text.text="图鉴 "+this.total_card+"张";var t=this,e=new egret.ImageLoader;e.crossOrigin="anonymous",e.load(this.head_url),e.once(egret.Event.COMPLETE,function(e){if(e.currentTarget.data){egret.log("加载头像成功: "+e.currentTarget.data);var i=new egret.Texture;i.bitmapData=e.currentTarget.data,t.player_head.texture=i}},this)},e.prototype.setPlayerData=function(t,e){this.rank_index=t,this.rank_index<4&&(this.head_crown.texture=RES.getRes("crown_sheet").getTexture("crown"+this.rank_index),this.head_crown.x=this.player_head.x+this.player_head.width-this.head_crown.width,this.addChild(this.head_crown)),this.player_name=e.nick,this.total_card=e.score,this.head_url=e.url,this.updateView()},e}(egret.Sprite);__reflect(RankItem.prototype,"RankItem");var SelectPanel=function(t){function e(e){var i=t.call(this)||this;return i.stageList=[],i.initView(e),i}return __extends(e,t),e.prototype.initView=function(t){var e,i=Config.getInstance().select_json;if(6>t)for(var n=1+6*(t-1);6*t>=n;n++)e=new SelectStageView(n,i),this.addChild(e),this.stageList.push(e)},e.prototype.updateView=function(){for(var t=0;6>t;t++)this.stageList[t].updateStatus()},e.prototype.getStageList=function(){return this.stageList},e}(egret.DisplayObjectContainer);__reflect(SelectPanel.prototype,"SelectPanel");var SelectStageView=function(t){function e(e,i){var n=t.call(this)||this;return n.id=e,n.init(e,i),n}return __extends(e,t),e.prototype.init=function(t,e){var i=new TSBitmap("st"+t+"btn_png",null,!0);i.x=e["act"+t].x,i.y=e["act"+t].y,this.addChild(i),this.clear=new TSBitmap("clearImage_png"),this.clear.anchorOffsetX=this.clear.width/2,this.clear.anchorOffsetY=this.clear.height/2,this.clear.x=e["act"+t].x+e["act"+t].clear.x,this.clear.y=e["act"+t].y+e["act"+t].clear.y,this.addChild(this.clear),this.updateStatus(),this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onSelected,this)},e.prototype.onSelected=function(){SoundManager.getInstance().playSound(SoundEnum.SELECTSOUND_MP3),StageController.getInstance().setSelect(this.id)},e.prototype.updateStatus=function(){if(StageController.getInstance().isStageOpen(this.id))this.filters=[];else{var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);this.filters=[e]}StageController.getInstance().isStageClear(this.id)?this.clear.visible=!0:this.clear.visible=!1},e.prototype.setSelected=function(t){},e.prototype.getStageName=function(){return this.stageName},e}(egret.Sprite);__reflect(SelectStageView.prototype,"SelectStageView");var TitleHead=function(t){function e(e){var i=t.call(this)||this;return i.init(e),i}return __extends(e,t),e.prototype.init=function(t){var e=new TSBitmap("head",t);e.x=-120,e.y=-160,this.addChild(e),this.ours=new egret.Bitmap,this.ours.texture=RES.getRes("other_games_png"),this.ours.anchorOffsetX=this.ours.width/2,this.ours.anchorOffsetY=this.ours.height/2,this.ours.x=340-platform.offsetHead(),this.ours.y=40,this.ours.visible=!0,this.ours.touchEnabled=!0,this.addChild(this.ours),this.ours.addEventListener(egret.TouchEvent.TOUCH_TAP,this.otherGames,this),this.data_entrance=new TSBitmap("data_scene",t,!0),this.data_entrance.x=460-platform.offsetHead(),this.data_entrance.y=40,this.data_entrance.touchEnabled=!0,this.addChild(this.data_entrance),this.data_entrance.addEventListener(egret.TouchEvent.TOUCH_TAP,this.dataShow,this),this.voice=new egret.Sprite,this.voice.x=580-platform.offsetHead(),this.voice.y=40,this.addChild(this.voice),this.voice.touchEnabled=!0,this.voice.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeVoice,this),this.rank_btn=new TSBitmap("rank",t,!0),this.rank_btn.x=340-platform.offsetHead(),this.rank_btn.y=40,this.addChild(this.rank_btn),this.rank_btn.touchEnabled=!0,this.rank_btn.visible=platform.existRank(),this.rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rankShow,this),"wxgame"===platform.name;var i=new TSBitmap("on",t,!0);i.name="on",this.voice.addChild(i);var n=new TSBitmap("off",t,!0);n.name="off",this.voice.addChild(n),this.showVoice();var r=new TSBitmap("dialog",t);r.x=434.65,r.y=101.9,r.visible=!1,this.addChild(r)},e.prototype.updateView=function(){this.showVoice()},e.prototype.showVoice=function(){SettingController.getInstance().SoundPlaying?(this.voice.getChildByName("off").visible=!1,this.voice.getChildByName("on").visible=!0):(this.voice.getChildByName("on").visible=!1,this.voice.getChildByName("off").visible=!0)},e.prototype.changeVoice=function(){SettingController.getInstance().SoundPlaying?SettingController.getInstance().SoundPlaying=!1:SettingController.getInstance().SoundPlaying=!0,this.showVoice()},e.prototype.otherGames=function(){AdManager.getInstance().showAppBox()},e.prototype.dataShow=function(){UIManager.getInstance().toDataScene()},e.prototype.onMtgIconClick=function(){},e.prototype.rankShow=function(){"wxgame"===platform.name?UIManager.getInstance().toRankScene():platform.rankView(!0)},e}(egret.Sprite);__reflect(TitleHead.prototype,"TitleHead");var StageParse=function(t){function e(e,i){var n=t.call(this)||this;return n.gameid=0,n.stageid=0,n.items=[],n.key_list=[],n.isWaiting=!1,n.stageTexture={},n.actionNowDo=0,n.doingList=[],n.isDoing=!1,n.getItemPause=!1,n.pauseAction=-1,n.gameid=e,n.stageid=i,n._init(),n}return __extends(e,t),e.prototype._init=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,r;return __generator(this,function(s){switch(s.label){case 0:return UIManager.getInstance().showLoading(!0),[4,this._loadRes()];case 1:for(s.sent(),this.stageScript=window.top.stageScript,this.scene=new egret.Sprite,t=RES.getRes("scene_json"),e=t.child,i=0;i<e.length;i++)console.log(e[i]),n=e[i].props,r=new egret.Bitmap,console.log(n.texture.replace("/","_").replace(".","_")),r.texture=RES.getRes(n.texture.replace("/","_").replace(".","_")),r.x=Number(n.x),r.y=Number(n.y),r.width=Number(n.width),r.height=Number(n.height),r.scaleX=void 0===n.scaleX?1:Number(n.scaleX),r.scaleY=void 0===n.scaleY?1:Number(n.scaleY),r.alpha=void 0===n.alpha?1:Number(n.alpha),r.rotation=void 0===n.rotation?0:Number(n.rotation),r.visible=void 0===n.visible?!0:n.visible,"mActor"===n["var"]?(this[n["var"]]=r,this.addChild(r)):void 0!==n["var"]?(this[n["var"]]=r,this.scene.addChild(this[n["var"]])):this.scene.addChild(r);return this.leftArrow=new TSBitmap("arrow_png"),this.leftArrow.scaleX=-1,this.leftArrow.x=150,this.leftArrow.y=Util.curHeight()-400,this.leftArrow.touchEnabled=!0,this.addChild(this.leftArrow),this.rightArrow=new TSBitmap("arrow_png"),this.rightArrow.x=Util.curWidth()-150,this.rightArrow.y=Util.curHeight()-400,this.rightArrow.touchEnabled=!0,this.addChild(this.rightArrow),this.leftArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftArrowTouched,this),this.rightArrow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightArrowTouched,this),void 0===e.position&&(this.leftArrow.visible=!1),this.addChildAt(this.scene,0),this.initKey(),this.initItem(),this.initHint(),console.log(this),this.registEvents(),this.registAnimate(),[2]}})})},e.prototype.leftArrowTouched=function(t){var e=this;egret.Tween.get(this.scene).to({x:0},500).call(function(){e.rightArrow.visible=!0}),this.leftArrow.visible=!1},e.prototype.rightArrowTouched=function(t){var e=this;egret.Tween.get(this.scene).to({x:-720},500).call(function(){e.leftArrow.visible=!0},this),this.rightArrow.visible=!1},e.prototype.keyFactory=function(t){var e={id:Number(t.id),isOn:t.isOn};return e},e.prototype.initKey=function(){this.key_list=[];for(var t=0;t<this.stageScript.keys.length;t++)this.key_list.push(this.keyFactory(this.stageScript.keys[t]))},e.prototype.initItem=function(){this.items=[];for(var t=0;t<this.stageScript.items.length;t++)this.items.push(this.stageScript.items[t])},e.prototype.initHint=function(){HintController.getInstance().Hints=this.stageScript.hints.split(";"),console.log(HintController.getInstance().Hints)},e.prototype.registEvents=function(){for(var t=this,e=this.stageScript.events,i=function(i){var r=e[i];switch(r.type){case"touch":n[e[i].bind].touchEnabled=!0,void 0===n[e[i].bind].hasEvent&&(n[e[i].bind].hasEvent=!0,n[e[i].bind].event=[],n[e[i].bind].eventLocks=[],n[e[i].bind].eventOnce=[],n[e[i].bind].eventActions=[],n[e[i].bind].addEventListener(egret.TouchEvent.TOUCH_TAP,function(n){if(!t.isDoing){for(var r,s=[],a=0;a<t[e[i].bind].eventLocks.length;a++){if(r=!0,void 0===t[e[i].bind].eventLocks[a]||null===t[e[i].bind].eventLocks[a]||t[e[i].bind].eventLocks[a]===[]);else for(var o=0;o<t[e[i].bind].eventLocks[a].length;o++)t.checkLock(t[e[i].bind].eventLocks[a][o].id)!==t[e[i].bind].eventLocks[a][o].isOn&&(r=!1);s.push(r)}for(var h=0;h<s.length;h++)s[h]&&t.doActionList(t[e[i].bind].eventActions[h]);for(var c=0;c<s.length;c++)t[e[i].bind].eventOnce[c]&&(t[e[i].bind].event.splice(c,1),t[e[i].bind].eventLocks.splice(c,1),t[e[i].bind].eventOnce.splice(c,1),t[e[i].bind].eventActions.splice(c,1))}},n)),n[e[i].bind].event.push(r.id),n[e[i].bind].eventLocks.push(r.lock),n[e[i].bind].eventOnce.push(r.once),n[e[i].bind].eventActions.push(r.on);break;case"use_item":console.log(n.items[e[i].item]),n.items[e[i].item].useTarget=[],n.items[e[i].item].useTarget.push(e[i])}},n=this,r=0;r<e.length;r++)i(r);UIManager.getInstance().hideLoading()},e.prototype.registAnimate=function(){for(var t,e=this.stageScript.animates,i=0;i<e.length;i++){t=e[i].name;var n=new egret.MovieClipDataFactory(RES.getRes(t+"_json"),RES.getRes(t+"_png"));this["animate&"+e[i].name]=new egret.MovieClip(n.generateMovieClipData("default")),this["animate&"+e[i].name].visible=!1,this["animate&"+e[i].name].x=-1989,this["animate&"+e[i].name].y=-223,this["animate&"+e[i].name].gotoAndStop(0),this.scene.addChild(this["animate&"+e[i].name])}},e.prototype.doActionList=function(t){this.isWaiting||(this.actionNowDo=0,this.doingList=t,this.isDoing=!0,this.executeDo())},e.prototype.executeDo=function(){UIManager.getInstance().isPopUp||(this.actionNowDo<this.doingList.length?(console.log("执行动作"+this.doingList[this.actionNowDo]),this.doAction(this.doingList[this.actionNowDo])):(this.actionNowDo=0,this.doingList=[],this.isDoing=!1,console.log("finish actions")))},e.prototype.finishAction=function(t){this.actionNowDo++,this.executeDo()},e.prototype.doAction=function(t){var e=this,i=this.stageScript.actions[t];if("simple"===i.todo.type){console.log(i.actor),console.log(this[i.actor]);for(var n in i.todo.props)console.log("action"+i.todo.props[n]),this[i.actor][n]=i.todo.props[n];this.finishAction(t)}else"tween"===i.todo.type?egret.Tween.get(this[i.actor]).to(i.todo.props,Number(i.todo.time)).call(function(){e.finishAction(t)}):"item"===i.todo.type?(this.registItem(i.todo.item),this.getItemPause=!0,this.pauseAction=t):"key"===i.todo.type?(this.getLockKey(i.todo.key),this.finishAction(t)):"wait"===i.todo.type?(egret.Tween.get(this).wait(Number(i.todo.time)).call(function(){e.isWaiting=!1,e.finishAction(t)}),console.log(i.todo.time)):"clear"===i.todo.type?StageController.getInstance().clearStage(this.stageid,[],i.todo.res):"over"===i.todo.type?StageController.getInstance().gameOverStage(this.stageid,[],i.todo.res):"sound"===i.todo.type&&(SoundManager.getInstance().playSound(i.todo.res),this.finishAction(t))},e.prototype.checkLock=function(t){for(var e=0;e<this.key_list.length;e++)if(Number(this.key_list[e].id)===Number(t))return this.key_list[e].isOn;return null},e.prototype.getLockKey=function(t){for(var e=0;e<this.key_list.length;e++)Number(this.key_list[e].id)===Number(t.id)&&(this.key_list[e].isOn=t.isOn)},e.prototype._loadRes=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,StageController.getInstance().loadSelectURL(window.top.selectURL,Number(window.top.inputStageId))];case 1:return e.sent(),[3,3];case 2:return t=e.sent(),window.top.showLog=!0,window.top.logMsg="资源加载错误",console.error(t),[3,3];case 3:return[2]}})})},e.prototype._start=function(){},e.prototype.play_loop=function(){UIManager.getInstance().isPopUp===!1&&this.getItemPause===!0&&(this.getItemPause=!1,this.finishAction(this.pauseAction))},e.prototype.getDisplayArea=function(){return new egret.Rectangle},e.prototype._remove=function(){egret.Tween.removeAllTweens()},e.prototype.registItem=function(t){ItemController.getInstance().addItem(this.items[t])},e.prototype.useItem=function(t,e,i){if(this.isDoing)return!1;for(var n=0;n<this.items.length;n++)if(this.items[n].id===t)for(var r=0;r<this.items[n].useTarget.length;r++)if(this[this.items[n].useTarget[r].bind].hitTestPoint(e,i)){if(void 0===this.items[n].useTarget[r].lock||null===this.items[n].useTarget[r].lock||this.items[n].useTarget[r].lock===[])console.log("event"+this.items[n].useTarget[r].id+"not set lock");else for(var s=0;s<this.items[n].useTarget[r].lock.length;s++)if(this.checkLock(this.items[n].useTarget[r].lock[s].id)!==this.items[n].useTarget[r].lock[s].isOn)return;return this.doActionList(this.items[n].useTarget[r].on),!0}return!1},e}(egret.DisplayObjectContainer);__reflect(StageParse.prototype,"StageParse",["IFKaihiStage"]);